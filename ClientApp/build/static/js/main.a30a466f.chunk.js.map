{"version":3,"sources":["registerServiceWorker.js","actions/editor.js","actions/user.js","reducers/index.js","reducers/editor.js","reducers/renderMarkdown.js","actions/renderMarkdown.js","reducers/user.js","icons/arrow-down.svg","icons/toolbar/title.svg","icons/toolbar/bold.svg","icons/toolbar/italic.svg","icons/toolbar/quote.svg","icons/toolbar/code.svg","icons/toolbar/table.svg","icons/toolbar/link.svg","icons/toolbar/img.svg","icons/toolbar/divider.svg","icons/toolbar/ul.svg","icons/toolbar/ol.svg","components/Toolbar/ButtonList.js","components/Toolbar/Buttons.js","components/common/Avatar.js","components/Toolbar/Toolbar.js","components/Sidebar/Sidebar.js","vendor/Markdown.Converter.js","vendor/Markdown.Editor.js","vendor/modifiedGfm.js","components/Editor/Editor.js","icons/visibility-on.svg","icons/visibility-off.svg","components/Paper/Paper.js","components/App/App.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","receiveUserData","data","type","combineReducers","editor","arguments","length","undefined","codeMirror","action","renderMarkdown","user","ownFiles","secondFiles","currentFile","Object","objectSpread","_extends","assign","target","i","source","key","prototype","hasOwnProperty","call","apply","this","arrow_down_ref","react_default","a","createElement","d","fill","_ref2","arrow_down_SvgComponent","props","width","height","viewBox","__webpack_require__","p","title_extends","title_ref","bold_extends","bold_ref","italic_extends","italic_ref","quote_extends","quote_ref","code_extends","code_ref","table_extends","table_ref","link_extends","link_ref","img_extends","img_ref","divider_extends","divider_ref","divider_ref2","_ref3","divider_ref4","ul_extends","ul_ref","ol_extends","ol_ref","ButtonList","Icon","title","method","StyledButtons","styled","div","_templateObject","Buttons","map","_ref","index","onClick","doClick","Component","connect","img","Avatar_templateObject","Button","span","Toolbar_templateObject","StyledToolbar","_templateObject2","Wrapper","_templateObject3","Group","_templateObject4","LoginButton","_templateObject5","UserName","_templateObject6","Avatar","toggleRenderMarkdown","name","Toolbar_Buttons","secondName","photoURI","src","href","Markdown","StyledSidebar","Sidebar_templateObject","Item","Sidebar_templateObject2","hl","Text","Sidebar_templateObject3","_ref7","_ref4","Fragment","_ref5","nameHash","highlighted","_ref6","exports","identity","x","returnFalse","HookCollection","SaveHash","chain","hookname","func","original","Error","text","args","Array","slice","set","addNoop","addFalse","value","get","Converter","options","setOptions","optionsParam","g_urls","g_titles","g_html_blocks","g_list_level","pluginHooks","hooks","_HashHTMLBlocks","replace","hashElement","wholeMatch","m1","blockText","push","makeHtml","_Detab","preConversion","charCodeToReplace","parseInt","String","fromCharCode","_UnescapeSpecialChars","_RunBlockGamut","m2","m3","m4","m5","toLowerCase","_EncodeAmpsAndAngles","_StripLinkDefinitions","postNormalization","postConversion","blockGamutHookCallback","t","doNotUnhash","bq","pre","_DoBlockQuotes","codeblock","nextChar","_EncodeCode","_Outdent","_DoCodeBlocks","_DoLists","_RunSpanGamut","matchFound","h_level","_DoHeaders","preBlockGamut","grafs","split","grafsOut","markerRe","end","str","test","foundAny","id","join","_FormParagraphs","postBlockGamut","autoLinkRegex","handleTrailingParens","wholematch","plainLinkText","_DoAutoLinks","writeAnchorTag","_DoAnchors","writeImageTag","_DoImages","escapeCharacters_callback","_EncodeBackslashEscapes","tag","escapeCharacters","charAt","_EscapeSpecialCharsWithinTagAttributes","c","_DoCodeSpans","preSpanGamut","_DoItalicsAndBold","postSpanGamut","m6","m7","whole_match","link_text","link_id","url","search","result","_problemUrlChars","offset","charCodeAt","toString","encodeProblemUrlChars","attributeEncode","alt_text","isInsideParagraphlessListItem","whole_list","list","list_type","_ProcessListItems","runup","_listItemMarkers","ol","ul","list_str","marker","re","RegExp","last_item_had_a_double_newline","item","ends_with_double_newline","endCharRegex","lookbehind","protocol","link","parens","level","tail","trailingParens","lastChar","substr","v","spaces","skew","charsToEscape","afterBackslash","regexString","regex","util","position","ui","doc","document","nav","SETTINGS","uaSniffed","isIE","userAgent","isIE_5or6","isOpera","isMac","platform","defaultsStrings","bold","boldexample","italic","italicexample","linkdescription","linkdialog","quote","quoteexample","code","codeexample","image","imagedescription","imagedialog","olist","ulist","litem","heading","headingexample","hr","table","undo","redo","help","keyStrokes","win","mac","Chunks","PanelCollection","postfix","cm","buttonBar","getElementById","preview","input","TextareaState","panels","isInitialState","stateObj","inputArea","init","before","getRange","CodeMirror","Pos","getCursor","selection","getSelection","after","posFromIndex","Number","MAX_VALUE","setInputAreaSelectionStartEnd","scrollTop","setInputAreaSelection","setSelection","start","scroll","focus","restore","startIndex","startIndexMax","endIndex","endIndexMax","beforeMaxOffset","afterMaxOffset","replaceRange","substring","getChunks","chunk","startTag","endTag","setChunks","PreviewManager","converter","previewRefreshCallback","previewWrapper","timeout","elapsedTime","oldInputText","getDocScrollTop","innerHeight","pageYOffset","documentElement","body","makePreviewHtml","getValue","prevTime","Date","getTime","currTime","pushPreviewHtml","applyTimeout","clearTimeout","delay","setTimeout","refresh","requiresRefresh","processingTime","previewSetter","isFirstTimeFilled","ieSafePreviewSet","parent","parentNode","sibling","nextSibling","removeChild","innerHTML","insertBefore","appendChild","nonSuckyBrowserPreviewSet","emptyTop","getTop","e","previewSet","panel","scrollHeight","clientHeight","setPanelScrollTops","fullTop","scrollBy","on","UIManager","undoManager","previewManager","commandManager","helpOptions","getString","getKey","getStringAndKey","identifier","inputBox","buttons","setUndoRedoButtonStates","setupButton","history","done","undone","that","buttonRow","className","xPosition","makeButton","XShift","textOp","button","style","left","buttonImage","makeSpacer","num","spacer","bindCommand","postProcessing","doLinkOrImage","doList","execute","manager","helpButton","helpButtonImage","isHelp","right","onclick","handler","makeSpritedButtonRow","linkOrImage","setCommandMode","chunks","fixupInputArea","isEnabled","getElementsByTagName","backgroundPosition","onmouseover","onmouseout","onmousedown","activeElement","ieCachedRange","createRange","ieCachedScrollTop","identifierList","eKeys","addKeyMap","addKeyCmd","setButtonState","CommandManager","Editor","markdownConverter","idPostfix","strings","getConverter","run","uiManager","onPreviewRefresh","refreshPreview","findTags","startRegex","endRegex","chunkObj","extendRegExp","trimWhitespace","remove","beforeReplacer","afterReplacer","s","skipLines","nLinesBefore","nLinesAfter","findExtraNewlines","regexText","replacementText","$1","isVisible","elem","getComputedStyle","getPropertyValue","currentStyle","addEvent","event","listener","attachEvent","addEventListener","removeEvent","detachEvent","removeEventListener","fixEolChars","post","flags","pattern","flagsPart","isInner","offsetTop","offsetParent","getHeight","offsetHeight","getWidth","offsetWidth","scrollWidth","getPageSize","innerWidth","scrollMaxY","clientWidth","Math","max","createBackground","background","top","zIndex","filter","opacity","pageSize","scrollLeft","prompt","defaultInputText","callback","dialog","checkEscape","charCode","keyCode","close","isCancel","padding","question","form","onsubmit","margin","cssFloat","textAlign","display","marginLeft","marginRight","okButton","cancelButton","marginTop","createDialog","commandProto","prefixes","unwrap","txt","wrap","len","line","marked","doBold","doBorI","doItalic","nStars","insertText","starsBefore","exec","starsAfter","prevStars","min","whitespace","markup","stripLinkDefs","defsToAdd","totalMatch","newlines","addLinkDef","linkDef","refNumber","defs","addDefNumber","def","getLink","inner","afterInner","refOut","isImage","linkEnteredCallback","querypart","decodeURIComponent","encodeURI","trim","insertImageDialog","insertLinkDialog","doAutoindent","fakeSelection","doBlockquote","doCode","newlinesBefore","newlinesAfter","blankLine","leftOver","lines","inChain","good","replaceBlanksInTags","useBracket","replacement","markdown","postBlockquoteCreation","blanks","hasTextBefore","nLinesBack","nLinesForward","isNumberedList","nextItemsRegex","bullet","getItemPrefix","prefix","getPrefixedItem","itemText","_","hasDigits","nLinesUp","nLinesDown","doHeading","headerLevel","lastMatch","headerLevelToCreate","headerChar","doHorizontalRule","doTable","urlRE","defineMode","config","modeConfig","codeDepth","gfmOverlay","startState","codeBlock","ateSpace","copyState","token","stream","combineTokens","skipToEnd","sol","peek","next","pos","eatWhile","difference","eatSpace","gitHubSpice","string","markdownConfig","taskLists","strikethrough","emoji","attr","overlayMode","getMode","defineMIME","FakeButtonsElement","Editor_templateObject","editorRef","createRef","pagedownConverter","PagedownConverter","pagedownEditor","PagedownEditor","fromTextArea","current","mode","allowAtxHeaderWithoutSpace","highlightFormatting","maxBlockquoteDepth","fencedCodeBlockHighlighting","lineWrapping","setCmInstance","stopWatch","sharews","WebSocket","sharedoc","ShareDB","Connection","create","ed","chg","stindex","indexFromPos","from","delta","removed","addedText","submitOp","stPos","edPos","hdPos","edindex","prefixed","socket","emit","subscribe","setValue","setCursor","op","mine","delCt","addName","userslist","querySelector","usericon","classList","add","concat","color","idToColor","styleTag","hexToRgbaStyle","anchorMap","setAnchor","anchor","forEach","m","clear","emptyClass","markText","removeId","total","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","err","return","hex","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","r","g","b","io","clearAll","once","anchors","names","ref","mapDispatchToProps","visibility_on_extends","visibility_on_ref","visibility_on_ref2","visibility_on_SvgComponent","visibility_off_extends","visibility_off_ref","visibility_off_ref2","visibility_off_SvgComponent","Paper_templateObject","StyledPaper","Paper_templateObject2","VisibilityWrapper","Paper_templateObject3","visible","MarkdownRenderWrapper","Paper_templateObject4","RenderButton","Paper_templateObject5","Paper","_this$props","Paper_Wrapper","components_Editor_Editor","react_markdown_default","GlobalStyle","createGlobalStyle","App_templateObject","App","requestUserData","components_Toolbar_Toolbar","components_Sidebar_Sidebar","components_Paper_Paper","asyncToGenerator","regenerator_default","mark","_callee","dispatch","_context","prev","fetch","sent","t0","t1","json","t2","t3","t4","warn","stop","_x","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","rootReducer","applyMiddleware","thunkMiddleware","render","es","components_App_App","URL","process","origin","response","status","headers","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.a30a466f.chunk.js","sourcesContent":["// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export const SET_CM_INSTANCE = 'SET_CM_INSTANCE'\n\nexport const setCmInstance = ({ codeMirror, doClick }) => ({\n\ttype: SET_CM_INSTANCE,\n\teditor: {\n\t\tcodeMirror,\n\t\tdoClick,\n\t},\n})\n","export const RECEIVE_USER_DATA = 'RECEIVE_USER_DATA'\n\nexport const requestUserData = () => async dispatch => {\n\ttry {\n\t\tconst data = await fetch('/users')\n\t\tdispatch(receiveUserData(await data.json()))\n\t} catch (err) {\n\t\tconsole.warn(err)\n\t}\n}\n\nexport const receiveUserData = data => ({\n\ttype: RECEIVE_USER_DATA,\n\tdata,\n})\n","import { combineReducers } from 'redux'\nimport editor from './editor'\nimport renderMarkdown from './renderMarkdown'\nimport user from './user'\n\nexport default combineReducers({\n\teditor,\n\trenderMarkdown,\n\tuser,\n})\n","import { SET_CM_INSTANCE } from '../actions/editor'\n\nexport default (state = { codeMirror: {} }, action) => {\n\tswitch (action.type) {\n\t\tcase SET_CM_INSTANCE:\n\t\t\treturn action.editor\n\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","import { TOGGLE_RENDER_MARKDOWN } from '../actions/renderMarkdown'\n\nexport default (state = false, action) => {\n\tswitch (action.type) {\n\t\tcase TOGGLE_RENDER_MARKDOWN:\n\t\t\treturn !state\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","export const TOGGLE_RENDER_MARKDOWN = 'TOGGLE_RENDER_MARKDOWN'\n\nexport const toggleRenderMarkdown = () => ({\n\ttype: TOGGLE_RENDER_MARKDOWN,\n})\n","import { RECEIVE_USER_DATA } from '../actions/user'\n\nexport default (\n\tstate = {\n\t\townFiles: [],\n\t\tsecondFiles: [],\n\t\tcurrentFile: {},\n\t},\n\taction\n) => {\n\tswitch (action.type) {\n\t\tcase RECEIVE_USER_DATA:\n\t\t\treturn { ...action.data, currentFile: action.data.ownFiles[0] }\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M11 0L12 1L6 7V5L11 0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1 0L-1.90735e-06 1L6 7V5L1 0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 7,\n    viewBox: \"0 0 12 7\",\n    fill: \"none\"\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/arrow-down.b1b39921.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0V3H5.5V15H8.5V3H14V0H0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 15,\n    viewBox: \"0 0 14 15\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/title.01200e3f.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M8.6 6.79C9.57 6.12 10.25 5.02 10.25 4C10.25 1.74 8.5 0 6.25 0H0V14H7.04C9.13 14 10.75 12.3 10.75 10.21C10.75 8.69 9.89 7.39 8.6 6.79ZM3 2.5H6C6.83 2.5 7.5 3.17 7.5 4C7.5 4.83 6.83 5.5 6 5.5H3V2.5ZM6.5 11.5H3V8.5H6.5C7.33 8.5 8 9.17 8 10C8 10.83 7.33 11.5 6.5 11.5Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 11,\n    height: 14,\n    viewBox: \"0 0 11 14\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/bold.52868e47.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M4 0V3H6.21L2.79 11H0V14H8V11H5.79L9.21 3H12V0H4Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 12,\n    height: 14,\n    viewBox: \"0 0 12 14\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/italic.8b131a48.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1 10H4L6 6V0H0V6H3L1 10ZM9 10H12L14 6V0H8V6H11L9 10Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 14,\n    height: 10,\n    viewBox: \"0 0 14 10\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/quote.b500190f.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M7.4 10.6L2.8 6L7.4 1.4L6 0L0 6L6 12L7.4 10.6ZM12.6 10.6L17.2 6L12.6 1.4L14 0L20 6L14 12L12.6 10.6Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 12,\n    viewBox: \"0 0 20 12\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/code.78b4053b.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 18H2V16H0V18ZM4 18H6V16H4V18ZM2 4H0V6H2V4ZM0 14H2V12H0V14ZM6 0H4V2H6V0ZM2 0H0V2H2V0ZM14 0H12V2H14V0ZM16 6H18V4H16V6ZM16 0V2H18V0H16ZM12 18H14V16H12V18ZM10 0H8V8H0V10H8V18H10V10H18V8H10V0ZM16 18H18V16H16V18ZM16 14H18V12H16V14Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/table.dea78394.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M1.9 5C1.9 3.29 3.29 1.9 5 1.9H9V0H5C2.24 0 0 2.24 0 5C0 7.76 2.24 10 5 10H9V8.1H5C3.29 8.1 1.9 6.71 1.9 5ZM6 6H14V4H6V6ZM15 0H11V1.9H15C16.71 1.9 18.1 3.29 18.1 5C18.1 6.71 16.71 8.1 15 8.1H11V10H15C17.76 10 20 7.76 20 5C20 2.24 17.76 0 15 0Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 20,\n    height: 10,\n    viewBox: \"0 0 20 10\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/link.acd546b6.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M18 16V2C18 0.9 17.1 0 16 0H2C0.9 0 0 0.9 0 2V16C0 17.1 0.9 18 2 18H16C17.1 18 18 17.1 18 16ZM5.5 10.5L8 13.51L11.5 9L16 15H2L5.5 10.5Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 18,\n    viewBox: \"0 0 18 18\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/img.664e1d27.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 13.5H4.5V12H2V13.5ZM2 16H7.5V14.5H2V16ZM4.5 0H2V1.5H4.5V0ZM15 0H6.5V1.5H15V0ZM9.5 16H14V14.5H9.5V16ZM0 9H18V7H0V9Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 2.5H7.5V4H2V2.5Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M6 12H15.5V13.5H6V12Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M9.5 2.5H15.5V4H9.5V2.5Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 18,\n    height: 16,\n    viewBox: \"0 0 18 16\",\n    fill: \"none\"\n  }, props), _ref, _ref2, _ref3, _ref4);\n};\n\nexport default __webpack_public_path__ + \"static/media/divider.3d434b25.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M2 6.5C1.17 6.5 0.5 7.17 0.5 8C0.5 8.83 1.17 9.5 2 9.5C2.83 9.5 3.5 8.83 3.5 8C3.5 7.17 2.83 6.5 2 6.5ZM2 0.5C1.17 0.5 0.5 1.17 0.5 2C0.5 2.83 1.17 3.5 2 3.5C2.83 3.5 3.5 2.83 3.5 2C3.5 1.17 2.83 0.5 2 0.5ZM2 12.5C1.17 12.5 0.5 13.18 0.5 14C0.5 14.82 1.18 15.5 2 15.5C2.82 15.5 3.5 14.82 3.5 14C3.5 13.18 2.83 12.5 2 12.5ZM5 15H19V13H5V15ZM5 9H19V7H5V9ZM5 1V3H19V1H5Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/ul.512a0d65.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 13H2V13.5H1V14.5H2V15H0V16H3V12H0V13ZM1 4H2V0H0V1H1V4ZM0 7H1.8L0 9.1V10H3V9H1.2L3 6.9V6H0V7ZM5 1V3H19V1H5ZM5 15H19V13H5V15ZM5 9H19V7H5V9Z\",\n  fill: \"#EEEEEE\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 19,\n    height: 16,\n    viewBox: \"0 0 19 16\",\n    fill: \"none\"\n  }, props), _ref);\n};\n\nexport default __webpack_public_path__ + \"static/media/ol.0789ebe4.svg\";\nexport { SvgComponent as ReactComponent };","import { ReactComponent as TitleIcon } from '../../icons/toolbar/title.svg'\nimport { ReactComponent as BoldIcon } from '../../icons/toolbar/bold.svg'\nimport { ReactComponent as ItalicIcon } from '../../icons/toolbar/italic.svg'\nimport { ReactComponent as QuoteIcon } from '../../icons/toolbar/quote.svg'\nimport { ReactComponent as CodeIcon } from '../../icons/toolbar/code.svg'\nimport { ReactComponent as TableIcon } from '../../icons/toolbar/table.svg'\nimport { ReactComponent as LinkIcon } from '../../icons/toolbar/link.svg'\nimport { ReactComponent as ImgIcon } from '../../icons/toolbar/img.svg'\nimport { ReactComponent as DividerIcon } from '../../icons/toolbar/divider.svg'\nimport { ReactComponent as UlIcon } from '../../icons/toolbar/ul.svg'\nimport { ReactComponent as OlIcon } from '../../icons/toolbar/ol.svg'\n\nexport default [\n\t{ Icon: TitleIcon, title: 'Heading', method: 'heading' },\n    { Icon: BoldIcon, title: 'Bold', method: 'bold' },\n    { Icon: ItalicIcon, title: 'Italic', method: 'italic' },\n    { Icon: QuoteIcon, title: 'Blockquote', method: 'quote' },\n    { Icon: CodeIcon, title: 'Code', method: 'code' },\n    { Icon: TableIcon, title: 'Table', method: 'table' },\n    { Icon: LinkIcon, title: 'Link', method: 'link' },\n    { Icon: ImgIcon, title: 'Image', method: 'image' },\n    { Icon: DividerIcon , title: 'Divider', method: 'hr'},\n    { Icon: UlIcon, title: 'Unordered list', method: 'ulist' },\n    { Icon: OlIcon, title: 'Ordered list', method: 'olist' },\n]\n","import React, { Component } from 'react'\nimport styled from 'styled-components'\nimport { connect } from 'react-redux'\n\nimport ButtonList from './ButtonList'\n\nconst StyledButtons = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tsvg {\n\t\tmargin: 0 15px;\n\t\tcursor: pointer;\n\t}\n`\n\nclass Buttons extends Component {\n\tcomponentDidMount() {}\n\n\trender() {\n\t\tconst { editor } = this.props\n\n\t\treturn (\n\t\t\t<StyledButtons>\n\t\t\t\t{ButtonList.map(({ Icon, method }, index) => (\n                    <Icon key={index} onClick={() => editor.doClick(method)} fill=\"var(--c-lightgrey-text)\" />\n\t\t\t\t))}\n\t\t\t</StyledButtons>\n\t\t)\n\t}\n}\n\nexport default connect(({ editor }) => ({ editor }))(Buttons)\n","import styled from 'styled-components'\n\nexport default styled.img`\n\twidth: 35px;\n\theight: 35px;\n\tborder-radius: 50%;\n`\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport styled from 'styled-components'\nimport { ReactComponent as ArrowDownIcon } from '../../icons/arrow-down.svg'\nimport Buttons from './Buttons'\nimport Avatar from '../common/Avatar'\n\nconst Button = styled.span`\n\tcursor: pointer;\n`\n\nconst StyledToolbar = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n\tbackground-color: var(--c-darkgrey-bg);\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 2;\n`\n\nconst Wrapper = styled.div`\n\twidth: 100vw;\n\tmax-width: var(--container-width);\n\theight: 60px;\n\tdisplay: flex;\n\tjustify-content: space-between;\n`\n\nconst Group = styled.div`\n\tdisplay: flex;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tcolor: var(--c-lightgrey-text);\n\tfont-weight: 200;\n\t&:nth-of-type(3n - 1) {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t}\n\t&:nth-of-type(3n) {\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\t}\n\tsvg {\n\t\tmargin-left: 15px;\n\t}\n`\n\nconst LoginButton = styled.a`\n\tfont-weight: 500;\n\tcolor: var(--c-blue-hl);\n\ttext-decoration: none;\n`\n\nconst UserName = styled.div`\n\tdisplay: flex;\n\talign-items: center;\n\tcursor: pointer;\n\theight: 100%;\n\t${Avatar} {\n\t\tmargin-left: 10px;\n\t}\n`\n\nconst Toolbar = ({ renderMarkdown, toggleRenderMarkdown, user }) => (\n\t<StyledToolbar>\n\t\t<Wrapper>\n\t\t\t<Group>\n\t\t\t\t{user.currentFile.name}\n\t\t\t\t<Button>\n\t\t\t\t\t<ArrowDownIcon />\n\t\t\t\t</Button>\n\t\t\t</Group>\n\t\t\t<Group>\n\t\t\t\t<Buttons />\n\t\t\t</Group>\n\t\t\t<Group>\n\t\t\t\t{user.name ? (\n\t\t\t\t\t<UserName>\n\t\t\t\t\t\t{user.name} {user.secondName}\n\t\t\t\t\t\t{user.photoURI && <Avatar src={user.photoURI} />}\n\t\t\t\t\t</UserName>\n\t\t\t\t) : (\n\t\t\t\t\t<LoginButton href={`http://localhost:5000/auth/google`}>Login</LoginButton>\n\t\t\t\t)}\n\t\t\t</Group>\n\t\t</Wrapper>\n\t</StyledToolbar>\n)\n\nconst mapStateToProps = ({ renderMarkdown, user }) => ({ renderMarkdown, user })\n\nexport default connect(\n\tmapStateToProps,\n\tnull\n)(Toolbar)\n","import React from 'react'\nimport { connect } from 'react-redux'\nimport styled from 'styled-components'\n\nconst StyledSidebar = styled.div`\n\tmargin-top: 40px;\n\twidth: calc((var(--max-width) - var(--container-width)) / 2);\n\tposition: fixed;\n\tmargin-left: 50vw;\n\tleft: calc((var(--max-width) / -2));\n`\n\nconst Item = styled.div`\n\tbackground-color: ${({ hl }) => (hl ? 'var(--c-white-hl)' : 'transparent')};\n\tborder-left: ${({ hl }) => (hl ? '4px' : 0)} solid var(--c-blue-hl);\n\tpadding: 8px 21px;\n\tpadding-left: ${({ hl }) => (hl ? '17px' : '21px')};\n\tfont-weight: 200;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n\tcolor: var(--c-darkgrey-text);\n\tcursor: pointer;\n\t&:hover {\n\t\tcolor: black;\n\t}\n`\n\nconst Text = styled.p`\n\tmargin: 50px 0 3px 21px;\n\tfont-weight: 500;\n\tfont-size: 0.9rem;\n\ttext-transform: uppercase;\n\tcolor: var(--c-grey-text);\n`\n\nconst Sidebar = ({ user }) => (\n\t<StyledSidebar>\n\t\t{!!user.ownFiles.length && (\n\t\t\t<>\n\t\t\t\t<Text>Own files</Text>\n\t\t\t\t{user.ownFiles.map(({ name, highlighted, nameHash }) => (\n\t\t\t\t\t<Item key={nameHash} hl={nameHash === user.currentFile.nameHash}>\n\t\t\t\t\t\t{name}\n\t\t\t\t\t</Item>\n\t\t\t\t))}\n\t\t\t</>\n\t\t)}\n\t\t{!!user.secondFiles.length && (\n\t\t\t<>\n\t\t\t\t<Text>Other's files</Text>\n\t\t\t\t{user.secondFiles.map(({ name, highlighted, nameHash }) => (\n\t\t\t\t\t<Item key={nameHash} hl={nameHash === user.currentFile.nameHash}>\n\t\t\t\t\t\t{name}\n\t\t\t\t\t</Item>\n\t\t\t\t))}\n\t\t\t</>\n\t\t)}\n\t</StyledSidebar>\n)\n\nconst mapStateToProps = ({ user }) => ({ user })\n\nexport default connect(mapStateToProps)(Sidebar)\n","/* eslint-disable */\n\nvar Markdown;\n\nif (typeof exports === \"object\" && typeof require === \"function\") // we're in a CommonJS (e.g. Node.js) module\n    Markdown = exports;\nelse\n    Markdown = {};\n    \n// The following text is included for historical reasons, but should\n// be taken with a pinch of salt; it's not all true anymore.\n\n//\n// Wherever possible, Showdown is a straight, line-by-line port\n// of the Perl version of Markdown.\n//\n// This is not a normal parser design; it's basically just a\n// series of string substitutions.  It's hard to read and\n// maintain this way,  but keeping Showdown close to the original\n// design makes it easier to port new features.\n//\n// More importantly, Showdown behaves like markdown.pl in most\n// edge cases.  So web applications can do client-side preview\n// in Javascript, and then build identical HTML on the server.\n//\n// This port needs the new RegExp functionality of ECMA 262,\n// 3rd Edition (i.e. Javascript 1.5).  Most modern web browsers\n// should do fine.  Even with the new regular expression features,\n// We do a lot of work to emulate Perl's regex functionality.\n// The tricky changes in this file mostly have the \"attacklab:\"\n// label.  Major or self-explanatory changes don't.\n//\n// Smart diff tools like Araxis Merge will be able to match up\n// this file with markdown.pl in a useful way.  A little tweaking\n// helps: in a copy of markdown.pl, replace \"#\" with \"//\" and\n// replace \"$text\" with \"text\".  Be sure to ignore whitespace\n// and line endings.\n//\n\n\n//\n// Usage:\n//\n//   var text = \"Markdown *rocks*.\";\n//\n//   var converter = new Markdown.Converter();\n//   var html = converter.makeHtml(text);\n//\n//   alert(html);\n//\n// Note: move the sample code to the bottom of this\n// file before uncommenting it.\n//\n\n(function () {\n\n    function identity(x) { return x; }\n    function returnFalse(x) { return false; }\n\n    function HookCollection() { }\n\n    HookCollection.prototype = {\n\n        chain: function (hookname, func) {\n            var original = this[hookname];\n            if (!original)\n                throw new Error(\"unknown hook \" + hookname);\n\n            if (original === identity)\n                this[hookname] = func;\n            else\n                this[hookname] = function (text) {\n                    var args = Array.prototype.slice.call(arguments, 0);\n                    args[0] = original.apply(null, args);\n                    return func.apply(null, args);\n                };\n        },\n        set: function (hookname, func) {\n            if (!this[hookname])\n                throw new Error(\"unknown hook \" + hookname);\n            this[hookname] = func;\n        },\n        addNoop: function (hookname) {\n            this[hookname] = identity;\n        },\n        addFalse: function (hookname) {\n            this[hookname] = returnFalse;\n        }\n    };\n\n    Markdown.HookCollection = HookCollection;\n\n    // g_urls and g_titles allow arbitrary user-entered strings as keys. This\n    // caused an exception (and hence stopped the rendering) when the user entered\n    // e.g. [push] or [__proto__]. Adding a prefix to the actual key prevents this\n    // (since no builtin property starts with \"s_\"). See\n    // http://meta.stackoverflow.com/questions/64655/strange-wmd-bug\n    // (granted, switching from Array() to Object() alone would have left only __proto__\n    // to be a problem)\n    function SaveHash() { }\n    SaveHash.prototype = {\n        set: function (key, value) {\n            this[\"s_\" + key] = value;\n        },\n        get: function (key) {\n            return this[\"s_\" + key];\n        }\n    };\n\n    Markdown.Converter = function () {\n        var options = {};\n        this.setOptions = function(optionsParam) {\n            options = optionsParam;\n        };\n        \n        var pluginHooks = this.hooks = new HookCollection();\n        \n        // given a URL that was encountered by itself (without markup), should return the link text that's to be given to this link\n        pluginHooks.addNoop(\"plainLinkText\");\n        \n        // called with the orignal text as given to makeHtml. The result of this plugin hook is the actual markdown source that will be cooked\n        pluginHooks.addNoop(\"preConversion\");\n        \n        // called with the text once all normalizations have been completed (tabs to spaces, line endings, etc.), but before any conversions have\n        pluginHooks.addNoop(\"postNormalization\");\n        \n        // Called with the text before / after creating block elements like code blocks and lists. Note that this is called recursively\n        // with inner content, e.g. it's called with the full text, and then only with the content of a blockquote. The inner\n        // call will receive outdented text.\n        pluginHooks.addNoop(\"preBlockGamut\");\n        pluginHooks.addNoop(\"postBlockGamut\");\n        \n        // called with the text of a single block element before / after the span-level conversions (bold, code spans, etc.) have been made\n        pluginHooks.addNoop(\"preSpanGamut\");\n        pluginHooks.addNoop(\"postSpanGamut\");\n        \n        // called with the final cooked HTML code. The result of this plugin hook is the actual output of makeHtml\n        pluginHooks.addNoop(\"postConversion\");\n\n        //\n        // Private state of the converter instance:\n        //\n\n        // Global hashes, used by various utility routines\n        var g_urls;\n        var g_titles;\n        var g_html_blocks;\n\n        // Used to track when we're inside an ordered or unordered list\n        // (see _ProcessListItems() for details):\n        var g_list_level;\n\n        this.makeHtml = function (text) {\n\n            //\n            // Main function. The order in which other subs are called here is\n            // essential. Link and image substitutions need to happen before\n            // _EscapeSpecialCharsWithinTagAttributes(), so that any *'s or _'s in the <a>\n            // and <img> tags get encoded.\n            //\n\n            // This will only happen if makeHtml on the same converter instance is called from a plugin hook.\n            // Don't do that.\n            if (g_urls)\n                throw new Error(\"Recursive call to converter.makeHtml\");\n        \n            // Create the private state objects.\n            g_urls = new SaveHash();\n            g_titles = new SaveHash();\n            g_html_blocks = [];\n            g_list_level = 0;\n\n            text = pluginHooks.preConversion(text);\n\n            // attacklab: Replace ~ with ~T\n            // This lets us use tilde as an escape char to avoid md5 hashes\n            // The choice of character is arbitray; anything that isn't\n            // magic in Markdown will work.\n            text = text.replace(/~/g, \"~T\");\n\n            // attacklab: Replace $ with ~D\n            // RegExp interprets $ as a special character\n            // when it's in a replacement string\n            text = text.replace(/\\$/g, \"~D\");\n\n            // Standardize line endings\n            text = text.replace(/\\r\\n/g, \"\\n\"); // DOS to Unix\n            text = text.replace(/\\r/g, \"\\n\"); // Mac to Unix\n\n            // Make sure text begins and ends with a couple of newlines:\n            text = \"\\n\\n\" + text + \"\\n\\n\";\n\n            // Convert all tabs to spaces.\n            text = _Detab(text);\n\n            // Strip any lines consisting only of spaces and tabs.\n            // This makes subsequent regexen easier to write, because we can\n            // match consecutive blank lines with /\\n+/ instead of something\n            // contorted like /[ \\t]*\\n+/ .\n            text = text.replace(/^[ \\t]+$/mg, \"\");\n            \n            text = pluginHooks.postNormalization(text);\n\n            // Turn block-level HTML blocks into hash entries\n            text = _HashHTMLBlocks(text);\n\n            // Strip link definitions, store in hashes.\n            text = _StripLinkDefinitions(text);\n\n            text = _RunBlockGamut(text);\n\n            text = _UnescapeSpecialChars(text);\n\n            // attacklab: Restore dollar signs\n            text = text.replace(/~D/g, \"$$\");\n\n            // attacklab: Restore tildes\n            text = text.replace(/~T/g, \"~\");\n\n            text = pluginHooks.postConversion(text);\n\n            g_html_blocks = g_titles = g_urls = null;\n\n            return text;\n        };\n\n        function _StripLinkDefinitions(text) {\n            //\n            // Strips link definitions from text, stores the URLs and titles in\n            // hash references.\n            //\n\n            // Link defs are in the form: ^[id]: url \"optional title\"\n\n            /*\n            text = text.replace(/\n                ^[ ]{0,3}\\[(.+)\\]:  // id = $1  attacklab: g_tab_width - 1\n                [ \\t]*\n                \\n?                 // maybe *one* newline\n                [ \\t]*\n                <?(\\S+?)>?          // url = $2\n                (?=\\s|$)            // lookahead for whitespace instead of the lookbehind removed below\n                [ \\t]*\n                \\n?                 // maybe one newline\n                [ \\t]*\n                (                   // (potential) title = $3\n                    (\\n*)           // any lines skipped = $4 attacklab: lookbehind removed\n                    [ \\t]+\n                    [\"(]\n                    (.+?)           // title = $5\n                    [\")]\n                    [ \\t]*\n                )?                  // title is optional\n                (?:\\n+|$)\n            /gm, function(){...});\n            */\n\n            text = text.replace(/^[ ]{0,3}\\[(.+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?(?=\\s|$)[ \\t]*\\n?[ \\t]*((\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+)/gm,\n                function (wholeMatch, m1, m2, m3, m4, m5) {\n                    m1 = m1.toLowerCase();\n                    g_urls.set(m1, _EncodeAmpsAndAngles(m2));  // Link IDs are case-insensitive\n                    if (m4) {\n                        // Oops, found blank lines, so it's not a title.\n                        // Put back the parenthetical statement we stole.\n                        return m3;\n                    } else if (m5) {\n                        g_titles.set(m1, m5.replace(/\"/g, \"&quot;\"));\n                    }\n\n                    // Completely remove the definition from the text\n                    return \"\";\n                }\n            );\n\n            return text;\n        }\n\n        function _HashHTMLBlocks(text) {\n\n            // Hashify HTML blocks:\n            // We only want to do this for block-level HTML tags, such as headers,\n            // lists, and tables. That's because we still want to wrap <p>s around\n            // \"paragraphs\" that are wrapped in non-block-level tags, such as anchors,\n            // phrase emphasis, and spans. The list of tags we're looking for is\n            // hard-coded:\n            var block_tags_a = \"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del\"\n            var block_tags_b = \"p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math\"\n\n            // First, look for nested blocks, e.g.:\n            //   <div>\n            //     <div>\n            //     tags for inner block must be indented.\n            //     </div>\n            //   </div>\n            //\n            // The outermost tags must start at the left margin for this to match, and\n            // the inner nested divs must be indented.\n            // We need to do this before the next, more liberal match, because the next\n            // match will start at the first `<div>` and stop at the first `</div>`.\n\n            // attacklab: This regex can be expensive when it fails.\n\n            /*\n            text = text.replace(/\n                (                       // save in $1\n                    ^                   // start of line  (with /m)\n                    <($block_tags_a)    // start tag = $2\n                    \\b                  // word break\n                                        // attacklab: hack around khtml/pcre bug...\n                    [^\\r]*?\\n           // any number of lines, minimally matching\n                    </\\2>               // the matching end tag\n                    [ \\t]*              // trailing spaces/tabs\n                    (?=\\n+)             // followed by a newline\n                )                       // attacklab: there are sentinel newlines at end of document\n            /gm,function(){...}};\n            */\n            text = text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\\b[^\\r]*?\\n<\\/\\2>[ \\t]*(?=\\n+))/gm, hashElement);\n\n            //\n            // Now match more liberally, simply from `\\n<tag>` to `</tag>\\n`\n            //\n\n            /*\n            text = text.replace(/\n                (                       // save in $1\n                    ^                   // start of line  (with /m)\n                    <($block_tags_b)    // start tag = $2\n                    \\b                  // word break\n                                        // attacklab: hack around khtml/pcre bug...\n                    [^\\r]*?             // any number of lines, minimally matching\n                    .*</\\2>             // the matching end tag\n                    [ \\t]*              // trailing spaces/tabs\n                    (?=\\n+)             // followed by a newline\n                )                       // attacklab: there are sentinel newlines at end of document\n            /gm,function(){...}};\n            */\n            text = text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\\b[^\\r]*?.*<\\/\\2>[ \\t]*(?=\\n+)\\n)/gm, hashElement);\n\n            // Special case just for <hr />. It was easier to make a special case than\n            // to make the other regex more complicated.  \n\n            /*\n            text = text.replace(/\n                \\n                  // Starting after a blank line\n                [ ]{0,3}\n                (                   // save in $1\n                    (<(hr)          // start tag = $2\n                        \\b          // word break\n                        ([^<>])*?\n                    \\/?>)           // the matching end tag\n                    [ \\t]*\n                    (?=\\n{2,})      // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/\\n[ ]{0,3}((<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            // Special case for standalone HTML comments:\n\n            /*\n            text = text.replace(/\n                \\n\\n                                            // Starting after a blank line\n                [ ]{0,3}                                        // attacklab: g_tab_width - 1\n                (                                               // save in $1\n                    <!\n                    (--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)   // see http://www.w3.org/TR/html-markup/syntax.html#comments and http://meta.stackoverflow.com/q/95256\n                    >\n                    [ \\t]*\n                    (?=\\n{2,})                                  // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/\\n\\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            // PHP and ASP-style processor instructions (<?...?> and <%...%>)\n\n            /*\n            text = text.replace(/\n                (?:\n                    \\n\\n            // Starting after a blank line\n                )\n                (                   // save in $1\n                    [ ]{0,3}        // attacklab: g_tab_width - 1\n                    (?:\n                        <([?%])     // $2\n                        [^\\r]*?\n                        \\2>\n                    )\n                    [ \\t]*\n                    (?=\\n{2,})      // followed by a blank line\n                )\n            /g,hashElement);\n            */\n            text = text.replace(/(?:\\n\\n)([ ]{0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g, hashElement);\n\n            return text;\n        }\n\n        function hashElement(wholeMatch, m1) {\n            var blockText = m1;\n\n            // Undo double lines\n            blockText = blockText.replace(/^\\n+/, \"\");\n\n            // strip trailing blank lines\n            blockText = blockText.replace(/\\n+$/g, \"\");\n\n            // Replace the element text with a marker (\"~KxK\" where x is its key)\n            blockText = \"\\n\\n~K\" + (g_html_blocks.push(blockText) - 1) + \"K\\n\\n\";\n\n            return blockText;\n        }\n        \n        var blockGamutHookCallback = function (t) { return _RunBlockGamut(t); }\n\n        function _RunBlockGamut(text, doNotUnhash) {\n            //\n            // These are all the transformations that form block-level\n            // tags like paragraphs, headers, and list items.\n            //\n            \n            text = pluginHooks.preBlockGamut(text, blockGamutHookCallback);\n            \n            text = _DoHeaders(text);\n\n            // Do Horizontal Rules:\n            var replacement = \"<hr />\\n\";\n            text = text.replace(/^[ ]{0,2}([ ]?\\*[ ]?){3,}[ \\t]*$/gm, replacement);\n            text = text.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \\t]*$/gm, replacement);\n            text = text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \\t]*$/gm, replacement);\n\n            text = _DoLists(text);\n            text = _DoCodeBlocks(text);\n            text = _DoBlockQuotes(text);\n            \n            text = pluginHooks.postBlockGamut(text, blockGamutHookCallback);\n\n            // We already ran _HashHTMLBlocks() before, in Markdown(), but that\n            // was to escape raw HTML in the original Markdown source. This time,\n            // we're escaping the markup we've just created, so that we don't wrap\n            // <p> tags around block-level tags.\n            text = _HashHTMLBlocks(text);\n            text = _FormParagraphs(text, doNotUnhash);\n\n            return text;\n        }\n\n        function _RunSpanGamut(text) {\n            //\n            // These are all the transformations that occur *within* block-level\n            // tags like paragraphs, headers, and list items.\n            //\n\n            text = pluginHooks.preSpanGamut(text);\n            \n            text = _DoCodeSpans(text);\n            text = _EscapeSpecialCharsWithinTagAttributes(text);\n            text = _EncodeBackslashEscapes(text);\n\n            // Process anchor and image tags. Images must come first,\n            // because ![foo][f] looks like an anchor.\n            text = _DoImages(text);\n            text = _DoAnchors(text);\n\n            // Make links out of things like `<http://example.com/>`\n            // Must come after _DoAnchors(), because you can use < and >\n            // delimiters in inline links like [this](<url>).\n            text = _DoAutoLinks(text);\n            \n            text = text.replace(/~P/g, \"://\"); // put in place to prevent autolinking; reset now\n            \n            text = _EncodeAmpsAndAngles(text);\n            text = options._DoItalicsAndBold ? options._DoItalicsAndBold(text) : _DoItalicsAndBold(text);\n\n            // Do hard breaks:\n            text = text.replace(/  +\\n/g, \" <br>\\n\");\n            \n            text = pluginHooks.postSpanGamut(text);\n\n            return text;\n        }\n\n        function _EscapeSpecialCharsWithinTagAttributes(text) {\n            //\n            // Within tags -- meaning between < and > -- encode [\\ ` * _] so they\n            // don't conflict with their use in Markdown for code, italics and strong.\n            //\n\n            // Build a regex to find HTML tags and comments.  See Friedl's \n            // \"Mastering Regular Expressions\", 2nd Ed., pp. 200-201.\n\n            // SE: changed the comment part of the regex\n\n            var regex = /(<[a-z\\/!$](\"[^\"]*\"|'[^']*'|[^'\">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;\n\n            text = text.replace(regex, function (wholeMatch) {\n                var tag = wholeMatch.replace(/(.)<\\/?code>(?=.)/g, \"$1`\");\n                tag = escapeCharacters(tag, wholeMatch.charAt(1) == \"!\" ? \"\\\\`*_/\" : \"\\\\`*_\"); // also escape slashes in comments to prevent autolinking there -- http://meta.stackoverflow.com/questions/95987\n                return tag;\n            });\n\n            return text;\n        }\n\n        function _DoAnchors(text) {\n            //\n            // Turn Markdown link shortcuts into XHTML <a> tags.\n            //\n            //\n            // First, handle reference-style links: [link text] [id]\n            //\n\n            /*\n            text = text.replace(/\n                (                           // wrap whole match in $1\n                    \\[\n                    (\n                        (?:\n                            \\[[^\\]]*\\]      // allow brackets nested one level\n                            |\n                            [^\\[]           // or anything else\n                        )*\n                    )\n                    \\]\n\n                    [ ]?                    // one optional space\n                    (?:\\n[ ]*)?             // one optional newline followed by spaces\n\n                    \\[\n                    (.*?)                   // id = $3\n                    \\]\n                )\n                ()()()()                    // pad remaining backreferences\n            /g, writeAnchorTag);\n            */\n            text = text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g, writeAnchorTag);\n\n            //\n            // Next, inline-style links: [link text](url \"optional title\")\n            //\n\n            /*\n            text = text.replace(/\n                (                           // wrap whole match in $1\n                    \\[\n                    (\n                        (?:\n                            \\[[^\\]]*\\]      // allow brackets nested one level\n                            |\n                            [^\\[\\]]         // or anything else\n                        )*\n                    )\n                    \\]\n                    \\(                      // literal paren\n                    [ \\t]*\n                    ()                      // no id, so leave $3 empty\n                    <?(                     // href = $4\n                        (?:\n                            \\([^)]*\\)       // allow one level of (correctly nested) parens (think MSDN)\n                            |\n                            [^()\\s]\n                        )*?\n                    )>?                \n                    [ \\t]*\n                    (                       // $5\n                        (['\"])              // quote char = $6\n                        (.*?)               // Title = $7\n                        \\6                  // matching quote\n                        [ \\t]*              // ignore any spaces/tabs between closing quote and )\n                    )?                      // title is optional\n                    \\)\n                )\n            /g, writeAnchorTag);\n            */\n\n            text = text.replace(/(\\[((?:\\[[^\\]]*\\]|[^\\[\\]])*)\\]\\([ \\t]*()<?((?:\\([^)]*\\)|[^()\\s])*?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g, writeAnchorTag);\n\n            //\n            // Last, handle reference-style shortcuts: [link text]\n            // These must come last in case you've also got [link test][1]\n            // or [link test](/foo)\n            //\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    \\[\n                    ([^\\[\\]]+)      // link text = $2; can't contain '[' or ']'\n                    \\]\n                )\n                ()()()()()          // pad rest of backreferences\n            /g, writeAnchorTag);\n            */\n            text = text.replace(/(\\[([^\\[\\]]+)\\])()()()()()/g, writeAnchorTag);\n\n            return text;\n        }\n\n        function writeAnchorTag(wholeMatch, m1, m2, m3, m4, m5, m6, m7) {\n            if (m7 == undefined) m7 = \"\";\n            var whole_match = m1;\n            var link_text = m2.replace(/:\\/\\//g, \"~P\"); // to prevent auto-linking withing the link. will be converted back after the auto-linker runs\n            var link_id = m3.toLowerCase();\n            var url = m4;\n            var title = m7;\n\n            if (url == \"\") {\n                if (link_id == \"\") {\n                    // lower-case and turn embedded newlines into spaces\n                    link_id = link_text.toLowerCase().replace(/ ?\\n/g, \" \");\n                }\n                url = \"#\" + link_id;\n\n                if (g_urls.get(link_id) != undefined) {\n                    url = g_urls.get(link_id);\n                    if (g_titles.get(link_id) != undefined) {\n                        title = g_titles.get(link_id);\n                    }\n                }\n                else {\n                    if (whole_match.search(/\\(\\s*\\)$/m) > -1) {\n                        // Special case for explicit empty url\n                        url = \"\";\n                    } else {\n                        return whole_match;\n                    }\n                }\n            }\n            url = encodeProblemUrlChars(url);\n            url = escapeCharacters(url, \"*_\");\n            var result = \"<a href=\\\"\" + url + \"\\\"\";\n\n            if (title != \"\") {\n                title = attributeEncode(title);\n                title = escapeCharacters(title, \"*_\");\n                result += \" title=\\\"\" + title + \"\\\"\";\n            }\n\n            result += \">\" + link_text + \"</a>\";\n\n            return result;\n        }\n\n        function _DoImages(text) {\n            //\n            // Turn Markdown image shortcuts into <img> tags.\n            //\n\n            //\n            // First, handle reference-style labeled images: ![alt text][id]\n            //\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    !\\[\n                    (.*?)           // alt text = $2\n                    \\]\n\n                    [ ]?            // one optional space\n                    (?:\\n[ ]*)?     // one optional newline followed by spaces\n\n                    \\[\n                    (.*?)           // id = $3\n                    \\]\n                )\n                ()()()()            // pad rest of backreferences\n            /g, writeImageTag);\n            */\n            text = text.replace(/(!\\[(.*?)\\][ ]?(?:\\n[ ]*)?\\[(.*?)\\])()()()()/g, writeImageTag);\n\n            //\n            // Next, handle inline images:  ![alt text](url \"optional title\")\n            // Don't forget: encode * and _\n\n            /*\n            text = text.replace(/\n                (                   // wrap whole match in $1\n                    !\\[\n                    (.*?)           // alt text = $2\n                    \\]\n                    \\s?             // One optional whitespace character\n                    \\(              // literal paren\n                    [ \\t]*\n                    ()              // no id, so leave $3 empty\n                    <?(\\S+?)>?      // src url = $4\n                    [ \\t]*\n                    (               // $5\n                        (['\"])      // quote char = $6\n                        (.*?)       // title = $7\n                        \\6          // matching quote\n                        [ \\t]*\n                    )?              // title is optional\n                    \\)\n                )\n            /g, writeImageTag);\n            */\n            text = text.replace(/(!\\[(.*?)\\]\\s?\\([ \\t]*()<?(\\S+?)>?[ \\t]*((['\"])(.*?)\\6[ \\t]*)?\\))/g, writeImageTag);\n\n            return text;\n        }\n        \n        function attributeEncode(text) {\n            // unconditionally replace angle brackets here -- what ends up in an attribute (e.g. alt or title)\n            // never makes sense to have verbatim HTML in it (and the sanitizer would totally break it)\n            return text.replace(/>/g, \"&gt;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\");\n        }\n\n        function writeImageTag(wholeMatch, m1, m2, m3, m4, m5, m6, m7) {\n            var whole_match = m1;\n            var alt_text = m2;\n            var link_id = m3.toLowerCase();\n            var url = m4;\n            var title = m7;\n\n            if (!title) title = \"\";\n\n            if (url == \"\") {\n                if (link_id == \"\") {\n                    // lower-case and turn embedded newlines into spaces\n                    link_id = alt_text.toLowerCase().replace(/ ?\\n/g, \" \");\n                }\n                url = \"#\" + link_id;\n\n                if (g_urls.get(link_id) != undefined) {\n                    url = g_urls.get(link_id);\n                    if (g_titles.get(link_id) != undefined) {\n                        title = g_titles.get(link_id);\n                    }\n                }\n                else {\n                    return whole_match;\n                }\n            }\n            \n            alt_text = escapeCharacters(attributeEncode(alt_text), \"*_[]()\");\n            url = escapeCharacters(url, \"*_\");\n            var result = \"<img src=\\\"\" + url + \"\\\" alt=\\\"\" + alt_text + \"\\\"\";\n\n            // attacklab: Markdown.pl adds empty title attributes to images.\n            // Replicate this bug.\n\n            //if (title != \"\") {\n            title = attributeEncode(title);\n            title = escapeCharacters(title, \"*_\");\n            result += \" title=\\\"\" + title + \"\\\"\";\n            //}\n\n            result += \" />\";\n\n            return result;\n        }\n\n        function _DoHeaders(text) {\n\n            // Setext-style headers:\n            //  Header 1\n            //  ========\n            //  \n            //  Header 2\n            //  --------\n            //\n            text = text.replace(/^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,\n                function (wholeMatch, m1) { return \"<h1>\" + _RunSpanGamut(m1) + \"</h1>\\n\\n\"; }\n            );\n\n            text = text.replace(/^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm,\n                function (matchFound, m1) { return \"<h2>\" + _RunSpanGamut(m1) + \"</h2>\\n\\n\"; }\n            );\n\n            // atx-style headers:\n            //  # Header 1\n            //  ## Header 2\n            //  ## Header 2 with closing hashes ##\n            //  ...\n            //  ###### Header 6\n            //\n\n            /*\n            text = text.replace(/\n                ^(\\#{1,6})      // $1 = string of #'s\n                [ \\t]*\n                (.+?)           // $2 = Header text\n                [ \\t]*\n                \\#*             // optional closing #'s (not counted)\n                \\n+\n            /gm, function() {...});\n            */\n\n            text = text.replace(/^(\\#{1,6})[ \\t]*(.+?)[ \\t]*\\#*\\n+/gm,\n                function (wholeMatch, m1, m2) {\n                    var h_level = m1.length;\n                    return \"<h\" + h_level + \">\" + _RunSpanGamut(m2) + \"</h\" + h_level + \">\\n\\n\";\n                }\n            );\n\n            return text;\n        }\n\n        function _DoLists(text, isInsideParagraphlessListItem) {\n            //\n            // Form HTML ordered (numbered) and unordered (bulleted) lists.\n            //\n\n            // attacklab: add sentinel to hack around khtml/safari bug:\n            // http://bugs.webkit.org/show_bug.cgi?id=11231\n            text += \"~0\";\n\n            // Re-usable pattern to match any entirel ul or ol list:\n\n            /*\n            var whole_list = /\n                (                                   // $1 = whole list\n                    (                               // $2\n                        [ ]{0,3}                    // attacklab: g_tab_width - 1\n                        ([*+-]|\\d+[.])              // $3 = first list item marker\n                        [ \\t]+\n                    )\n                    [^\\r]+?\n                    (                               // $4\n                        ~0                          // sentinel for workaround; should be $\n                        |\n                        \\n{2,}\n                        (?=\\S)\n                        (?!                         // Negative lookahead for another list item marker\n                            [ \\t]*\n                            (?:[*+-]|\\d+[.])[ \\t]+\n                        )\n                    )\n                )\n            /g\n            */\n            var whole_list = /^(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\n\n            if (g_list_level) {\n                text = text.replace(whole_list, function (wholeMatch, m1, m2) {\n                    var list = m1;\n                    var list_type = (m2.search(/[*+-]/g) > -1) ? \"ul\" : \"ol\";\n\n                    var result = _ProcessListItems(list, list_type, isInsideParagraphlessListItem);\n\n                    // Trim any trailing whitespace, to put the closing `</$list_type>`\n                    // up on the preceding line, to get it past the current stupid\n                    // HTML block parser. This is a hack to work around the terrible\n                    // hack that is the HTML block parser.\n                    result = result.replace(/\\s+$/, \"\");\n                    result = \"<\" + list_type + \">\" + result + \"</\" + list_type + \">\\n\";\n                    return result;\n                });\n            } else {\n                whole_list = /(\\n\\n|^\\n?)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(~0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/g;\n                text = text.replace(whole_list, function (wholeMatch, m1, m2, m3) {\n                    var runup = m1;\n                    var list = m2;\n\n                    var list_type = (m3.search(/[*+-]/g) > -1) ? \"ul\" : \"ol\";\n                    var result = _ProcessListItems(list, list_type);\n                    result = runup + \"<\" + list_type + \">\\n\" + result + \"</\" + list_type + \">\\n\";\n                    return result;\n                });\n            }\n\n            // attacklab: strip sentinel\n            text = text.replace(/~0/, \"\");\n\n            return text;\n        }\n\n        var _listItemMarkers = { ol: \"\\\\d+[.]\", ul: \"[*+-]\" };\n\n        function _ProcessListItems(list_str, list_type, isInsideParagraphlessListItem) {\n            //\n            //  Process the contents of a single ordered or unordered list, splitting it\n            //  into individual list items.\n            //\n            //  list_type is either \"ul\" or \"ol\".\n\n            // The $g_list_level global keeps track of when we're inside a list.\n            // Each time we enter a list, we increment it; when we leave a list,\n            // we decrement. If it's zero, we're not in a list anymore.\n            //\n            // We do this because when we're not inside a list, we want to treat\n            // something like this:\n            //\n            //    I recommend upgrading to version\n            //    8. Oops, now this line is treated\n            //    as a sub-list.\n            //\n            // As a single paragraph, despite the fact that the second line starts\n            // with a digit-period-space sequence.\n            //\n            // Whereas when we're inside a list (or sub-list), that line will be\n            // treated as the start of a sub-list. What a kludge, huh? This is\n            // an aspect of Markdown's syntax that's hard to parse perfectly\n            // without resorting to mind-reading. Perhaps the solution is to\n            // change the syntax rules such that sub-lists must start with a\n            // starting cardinal number; e.g. \"1.\" or \"a.\".\n\n            g_list_level++;\n\n            // trim trailing blank lines:\n            list_str = list_str.replace(/\\n{2,}$/, \"\\n\");\n\n            // attacklab: add sentinel to emulate \\z\n            list_str += \"~0\";\n\n            // In the original attacklab showdown, list_type was not given to this function, and anything\n            // that matched /[*+-]|\\d+[.]/ would just create the next <li>, causing this mismatch:\n            //\n            //  Markdown          rendered by WMD        rendered by MarkdownSharp\n            //  ------------------------------------------------------------------\n            //  1. first          1. first               1. first\n            //  2. second         2. second              2. second\n            //  - third           3. third                   * third\n            //\n            // We changed this to behave identical to MarkdownSharp. This is the constructed RegEx,\n            // with {MARKER} being one of \\d+[.] or [*+-], depending on list_type:\n        \n            /*\n            list_str = list_str.replace(/\n                (^[ \\t]*)                       // leading whitespace = $1\n                ({MARKER}) [ \\t]+               // list marker = $2\n                ([^\\r]+?                        // list item text   = $3\n                    (\\n+)\n                )\n                (?=\n                    (~0 | \\2 ({MARKER}) [ \\t]+)\n                )\n            /gm, function(){...});\n            */\n\n            var marker = _listItemMarkers[list_type];\n            var re = new RegExp(\"(^[ \\\\t]*)(\" + marker + \")[ \\\\t]+([^\\\\r]+?(\\\\n+))(?=(~0|\\\\1(\" + marker + \")[ \\\\t]+))\", \"gm\");\n            var last_item_had_a_double_newline = false;\n            list_str = list_str.replace(re,\n                function (wholeMatch, m1, m2, m3) {\n                    var item = m3;\n                    var leading_space = m1;\n                    var ends_with_double_newline = /\\n\\n$/.test(item);\n                    var contains_double_newline = ends_with_double_newline || item.search(/\\n{2,}/) > -1;\n\n                    if (contains_double_newline || last_item_had_a_double_newline) {\n                        item = _RunBlockGamut(_Outdent(item), /* doNotUnhash = */true);\n                    }\n                    else {\n                        // Recursion for sub-lists:\n                        item = _DoLists(_Outdent(item), /* isInsideParagraphlessListItem= */ true);\n                        item = item.replace(/\\n$/, \"\"); // chomp(item)\n                        if (!isInsideParagraphlessListItem) // only the outer-most item should run this, otherwise it's run multiple times for the inner ones\n                            item = _RunSpanGamut(item);\n                    }\n                    last_item_had_a_double_newline = ends_with_double_newline;\n                    return \"<li>\" + item + \"</li>\\n\";\n                }\n            );\n\n            // attacklab: strip sentinel\n            list_str = list_str.replace(/~0/g, \"\");\n\n            g_list_level--;\n            return list_str;\n        }\n\n        function _DoCodeBlocks(text) {\n            //\n            //  Process Markdown `<pre><code>` blocks.\n            //  \n\n            /*\n            text = text.replace(/\n                (?:\\n\\n|^)\n                (                               // $1 = the code block -- one or more lines, starting with a space/tab\n                    (?:\n                        (?:[ ]{4}|\\t)           // Lines must start with a tab or a tab-width of spaces - attacklab: g_tab_width\n                        .*\\n+\n                    )+\n                )\n                (\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))    // attacklab: g_tab_width\n            /g ,function(){...});\n            */\n\n            // attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n            text += \"~0\";\n\n            text = text.replace(/(?:\\n\\n|^\\n?)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=~0))/g,\n                function (wholeMatch, m1, m2) {\n                    var codeblock = m1;\n                    var nextChar = m2;\n\n                    codeblock = _EncodeCode(_Outdent(codeblock));\n                    codeblock = _Detab(codeblock);\n                    codeblock = codeblock.replace(/^\\n+/g, \"\"); // trim leading newlines\n                    codeblock = codeblock.replace(/\\n+$/g, \"\"); // trim trailing whitespace\n\n                    codeblock = \"<pre><code>\" + codeblock + \"\\n</code></pre>\";\n\n                    return \"\\n\\n\" + codeblock + \"\\n\\n\" + nextChar;\n                }\n            );\n\n            // attacklab: strip sentinel\n            text = text.replace(/~0/, \"\");\n\n            return text;\n        }\n\n        function hashBlock(text) {\n            text = text.replace(/(^\\n+|\\n+$)/g, \"\");\n            return \"\\n\\n~K\" + (g_html_blocks.push(text) - 1) + \"K\\n\\n\";\n        }\n\n        function _DoCodeSpans(text) {\n            //\n            // * Backtick quotes are used for <code></code> spans.\n            // \n            // * You can use multiple backticks as the delimiters if you want to\n            //   include literal backticks in the code span. So, this input:\n            //     \n            //      Just type ``foo `bar` baz`` at the prompt.\n            //     \n            //   Will translate to:\n            //     \n            //      <p>Just type <code>foo `bar` baz</code> at the prompt.</p>\n            //     \n            //   There's no arbitrary limit to the number of backticks you\n            //   can use as delimters. If you need three consecutive backticks\n            //   in your code, use four for delimiters, etc.\n            //\n            // * You can use spaces to get literal backticks at the edges:\n            //     \n            //      ... type `` `bar` `` ...\n            //     \n            //   Turns to:\n            //     \n            //      ... type <code>`bar`</code> ...\n            //\n\n            /*\n            text = text.replace(/\n                (^|[^\\\\])       // Character before opening ` can't be a backslash\n                (`+)            // $2 = Opening run of `\n                (               // $3 = The code block\n                    [^\\r]*?\n                    [^`]        // attacklab: work around lack of lookbehind\n                )\n                \\2              // Matching closer\n                (?!`)\n            /gm, function(){...});\n            */\n\n            text = text.replace(/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,\n                function (wholeMatch, m1, m2, m3, m4) {\n                    var c = m3;\n                    c = c.replace(/^([ \\t]*)/g, \"\"); // leading whitespace\n                    c = c.replace(/[ \\t]*$/g, \"\"); // trailing whitespace\n                    c = _EncodeCode(c);\n                    c = c.replace(/:\\/\\//g, \"~P\"); // to prevent auto-linking. Not necessary in code *blocks*, but in code spans. Will be converted back after the auto-linker runs.\n                    return m1 + \"<code>\" + c + \"</code>\";\n                }\n            );\n\n            return text;\n        }\n\n        function _EncodeCode(text) {\n            //\n            // Encode/escape certain characters inside Markdown code runs.\n            // The point is that in code, these characters are literals,\n            // and lose their special Markdown meanings.\n            //\n            // Encode all ampersands; HTML entities are not\n            // entities within a Markdown code span.\n            text = text.replace(/&/g, \"&amp;\");\n\n            // Do the angle bracket song and dance:\n            text = text.replace(/</g, \"&lt;\");\n            text = text.replace(/>/g, \"&gt;\");\n\n            // Now, escape characters that are magic in Markdown:\n            text = escapeCharacters(text, \"\\*_{}[]\\\\\", false);\n\n            // jj the line above breaks this:\n            //---\n\n            //* Item\n\n            //   1. Subitem\n\n            //            special char: *\n            //---\n\n            return text;\n        }\n\n        function _DoItalicsAndBold(text) {\n\n            // <strong> must go first:\n            text = text.replace(/([\\W_]|^)(\\*\\*|__)(?=\\S)([^\\r]*?\\S[\\*_]*)\\2([\\W_]|$)/g,\n            \"$1<strong>$3</strong>$4\");\n\n            text = text.replace(/([\\W_]|^)(\\*|_)(?=\\S)([^\\r\\*_]*?\\S)\\2([\\W_]|$)/g,\n            \"$1<em>$3</em>$4\");\n\n            return text;\n        }\n\n        function _DoBlockQuotes(text) {\n\n            /*\n            text = text.replace(/\n                (                           // Wrap whole match in $1\n                    (\n                        ^[ \\t]*>[ \\t]?      // '>' at the start of a line\n                        .+\\n                // rest of the first line\n                        (.+\\n)*             // subsequent consecutive lines\n                        \\n*                 // blanks\n                    )+\n                )\n            /gm, function(){...});\n            */\n\n            text = text.replace(/((^[ \\t]*>[ \\t]?.+\\n(.+\\n)*\\n*)+)/gm,\n                function (wholeMatch, m1) {\n                    var bq = m1;\n\n                    // attacklab: hack around Konqueror 3.5.4 bug:\n                    // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\n                    bq = bq.replace(/^[ \\t]*>[ \\t]?/gm, \"~0\"); // trim one level of quoting\n\n                    // attacklab: clean up hack\n                    bq = bq.replace(/~0/g, \"\");\n\n                    bq = bq.replace(/^[ \\t]+$/gm, \"\");     // trim whitespace-only lines\n                    bq = _RunBlockGamut(bq);             // recurse\n\n                    bq = bq.replace(/(^|\\n)/g, \"$1  \");\n                    // These leading spaces screw with <pre> content, so we need to fix that:\n                    bq = bq.replace(\n                            /(\\s*<pre>[^\\r]+?<\\/pre>)/gm,\n                        function (wholeMatch, m1) {\n                            var pre = m1;\n                            // attacklab: hack around Konqueror 3.5.4 bug:\n                            pre = pre.replace(/^  /mg, \"~0\");\n                            pre = pre.replace(/~0/g, \"\");\n                            return pre;\n                        });\n\n                    return hashBlock(\"<blockquote>\\n\" + bq + \"\\n</blockquote>\");\n                }\n            );\n            return text;\n        }\n\n        function _FormParagraphs(text, doNotUnhash) {\n            //\n            //  Params:\n            //    $text - string to process with html <p> tags\n            //\n\n            // Strip leading and trailing lines:\n            text = text.replace(/^\\n+/g, \"\");\n            text = text.replace(/\\n+$/g, \"\");\n\n            var grafs = text.split(/\\n{2,}/g);\n            var grafsOut = [];\n            \n            var markerRe = /~K(\\d+)K/;\n\n            //\n            // Wrap <p> tags.\n            //\n            var end = grafs.length;\n            for (var i = 0; i < end; i++) {\n                var str = grafs[i];\n\n                // if this is an HTML marker, copy it\n                if (markerRe.test(str)) {\n                    grafsOut.push(str);\n                }\n                else if (/\\S/.test(str)) {\n                    str = _RunSpanGamut(str);\n                    str = str.replace(/^([ \\t]*)/g, \"<p>\");\n                    str += \"</p>\"\n                    grafsOut.push(str);\n                }\n\n            }\n            //\n            // Unhashify HTML blocks\n            //\n            if (!doNotUnhash) {\n                end = grafsOut.length;\n                for (var i = 0; i < end; i++) {\n                    var foundAny = true;\n                    while (foundAny) { // we may need several runs, since the data may be nested\n                        foundAny = false;\n                        grafsOut[i] = grafsOut[i].replace(/~K(\\d+)K/g, function (wholeMatch, id) {\n                            foundAny = true;\n                            return g_html_blocks[id];\n                        });\n                    }\n                }\n            }\n            return grafsOut.join(\"\\n\\n\");\n        }\n\n        function _EncodeAmpsAndAngles(text) {\n            // Smart processing for ampersands and angle brackets that need to be encoded.\n\n            // Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:\n            //   http://bumppo.net/projects/amputator/\n            text = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g, \"&amp;\");\n\n            // Encode naked <'s\n            text = text.replace(/<(?![a-z\\/?!]|~D)/gi, \"&lt;\");\n\n            return text;\n        }\n\n        function _EncodeBackslashEscapes(text) {\n            //\n            //   Parameter:  String.\n            //   Returns:    The string, with after processing the following backslash\n            //               escape sequences.\n            //\n\n            // attacklab: The polite way to do this is with the new\n            // escapeCharacters() function:\n            //\n            //     text = escapeCharacters(text,\"\\\\\",true);\n            //     text = escapeCharacters(text,\"`*_{}[]()>#+-.!\",true);\n            //\n            // ...but we're sidestepping its use of the (slow) RegExp constructor\n            // as an optimization for Firefox.  This function gets called a LOT.\n\n            text = text.replace(/\\\\(\\\\)/g, escapeCharacters_callback);\n            text = text.replace(/\\\\([`*_{}\\[\\]()>#+-.!])/g, escapeCharacters_callback);\n            return text;\n        }\n\n        var charInsideUrl = \"[-A-Z0-9+&@#/%?=~_|[\\\\]()!:,.;]\",\n            charEndingUrl = \"[-A-Z0-9+&@#/%=~_|[\\\\])]\",\n            autoLinkRegex = new RegExp(\"(=\\\"|<)?\\\\b(https?|ftp)(://\" + charInsideUrl + \"*\" + charEndingUrl + \")(?=$|\\\\W)\", \"gi\"),\n            endCharRegex = new RegExp(charEndingUrl, \"i\");\n\n        function handleTrailingParens(wholeMatch, lookbehind, protocol, link) {\n            if (lookbehind)\n                return wholeMatch;\n            if (link.charAt(link.length - 1) !== \")\")\n                return \"<\" + protocol + link + \">\";\n            var parens = link.match(/[()]/g);\n            var level = 0;\n            for (var i = 0; i < parens.length; i++) {\n                if (parens[i] === \"(\") {\n                    if (level <= 0)\n                        level = 1;\n                    else\n                        level++;\n                }\n                else {\n                    level--;\n                }\n            }\n            var tail = \"\";\n            if (level < 0) {\n                var re = new RegExp(\"\\\\){1,\" + (-level) + \"}$\");\n                link = link.replace(re, function (trailingParens) {\n                    tail = trailingParens;\n                    return \"\";\n                });\n            }\n            if (tail) {\n                var lastChar = link.charAt(link.length - 1);\n                if (!endCharRegex.test(lastChar)) {\n                    tail = lastChar + tail;\n                    link = link.substr(0, link.length - 1);\n                }\n            }\n            return \"<\" + protocol + link + \">\" + tail;\n        }\n        \n        function _DoAutoLinks(text) {\n\n            // note that at this point, all other URL in the text are already hyperlinked as <a href=\"\"></a>\n            // *except* for the <http://www.foo.com> case\n\n            // automatically add < and > around unadorned raw hyperlinks\n            // must be preceded by a non-word character (and not by =\" or <) and followed by non-word/EOF character\n            // simulating the lookbehind in a consuming way is okay here, since a URL can neither and with a \" nor\n            // with a <, so there is no risk of overlapping matches.\n            text = text.replace(autoLinkRegex, handleTrailingParens);\n\n            //  autolink anything like <http://example.com>\n            \n            var replacer = function (wholematch, m1) { return \"<a href=\\\"\" + m1 + \"\\\">\" + pluginHooks.plainLinkText(m1) + \"</a>\"; }\n            text = text.replace(/<((https?|ftp):[^'\">\\s]+)>/gi, replacer);\n\n            // Email addresses: <address@domain.foo>\n            /*\n            text = text.replace(/\n                <\n                (?:mailto:)?\n                (\n                    [-.\\w]+\n                    \\@\n                    [-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+\n                )\n                >\n            /gi, _DoAutoLinks_callback());\n            */\n\n            /* disabling email autolinking, since we don't do that on the server, either\n            text = text.replace(/<(?:mailto:)?([-.\\w]+\\@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi,\n                function(wholeMatch,m1) {\n                    return _EncodeEmailAddress( _UnescapeSpecialChars(m1) );\n                }\n            );\n            */\n            return text;\n        }\n\n        function _UnescapeSpecialChars(text) {\n            //\n            // Swap back in all the special characters we've hidden.\n            //\n            text = text.replace(/~E(\\d+)E/g,\n                function (wholeMatch, m1) {\n                    var charCodeToReplace = parseInt(m1);\n                    return String.fromCharCode(charCodeToReplace);\n                }\n            );\n            return text;\n        }\n\n        function _Outdent(text) {\n            //\n            // Remove one level of line-leading tabs or spaces\n            //\n\n            // attacklab: hack around Konqueror 3.5.4 bug:\n            // \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\n            text = text.replace(/^(\\t|[ ]{1,4})/gm, \"~0\"); // attacklab: g_tab_width\n\n            // attacklab: clean up hack\n            text = text.replace(/~0/g, \"\")\n\n            return text;\n        }\n\n        function _Detab(text) {\n            if (!/\\t/.test(text))\n                return text;\n\n            var spaces = [\"    \", \"   \", \"  \", \" \"],\n            skew = 0,\n            v;\n\n            return text.replace(/[\\n\\t]/g, function (match, offset) {\n                if (match === \"\\n\") {\n                    skew = offset + 1;\n                    return match;\n                }\n                v = (offset - skew) % 4;\n                skew = offset + 1;\n                return spaces[v];\n            });\n        }\n\n        //\n        //  attacklab: Utility functions\n        //\n\n        var _problemUrlChars = /(?:[\"'*()[\\]:]|~D)/g;\n\n        // hex-encodes some unusual \"problem\" chars in URLs to avoid URL detection problems \n        function encodeProblemUrlChars(url) {\n            if (!url)\n                return \"\";\n\n            var len = url.length;\n\n            return url.replace(_problemUrlChars, function (match, offset) {\n                if (match == \"~D\") // escape for dollar\n                    return \"%24\";\n                if (match == \":\") {\n                    //if (offset == len - 1 || /[0-9\\/]/.test(url.charAt(offset + 1)))\n                        return \":\"\n                }\n                return \"%\" + match.charCodeAt(0).toString(16);\n            });\n        }\n\n\n        function escapeCharacters(text, charsToEscape, afterBackslash) {\n            // First we have to escape the escape characters so that\n            // we can build a character class out of them\n            var regexString = \"([\" + charsToEscape.replace(/([\\[\\]\\\\])/g, \"\\\\$1\") + \"])\";\n\n            if (afterBackslash) {\n                regexString = \"\\\\\\\\\" + regexString;\n            }\n\n            var regex = new RegExp(regexString, \"g\");\n            text = text.replace(regex, escapeCharacters_callback);\n\n            return text;\n        }\n\n\n        function escapeCharacters_callback(wholeMatch, m1) {\n            var charCodeToEscape = m1.charCodeAt(0);\n            return \"~E\" + charCodeToEscape + \"E\";\n        }\n\n    }; // end of the Markdown.Converter constructor\n\n})();\n\nexport default Markdown\n","/* eslint-disable */\n\nimport Markdown from './Markdown.Converter'\nimport CodeMirror from 'codemirror'\n\n// needs Markdown.Converter.js at the moment\n\n(function () {\n\n    \n    var util = {},\n        position = {},\n        ui = {},\n        doc = window.document,\n        re = window.RegExp,\n        nav = window.navigator,\n        SETTINGS = { lineLength: 72 },\n\n    // Used to work around some browser bugs where we can't use feature testing.\n        uaSniffed = {\n            isIE: /msie/.test(nav.userAgent.toLowerCase()),\n            isIE_5or6: /msie 6/.test(nav.userAgent.toLowerCase()) || /msie 5/.test(nav.userAgent.toLowerCase()),\n            isOpera: /opera/.test(nav.userAgent.toLowerCase()),\n            isMac: (/AppleWebKit/.test(nav.userAgent) && /Mobile\\/\\w+/.test(nav.userAgent)) || /Mac/.test(nav.platform)\n        };\n\n    var defaultsStrings = {\n        bold: \"Strong <strong>\",\n        boldexample: \"strong text\",\n        \n        italic: \"Emphasis <em>\",\n        italicexample: \"emphasized text\",\n        \n        link: \"Hyperlink <a>\",\n        linkdescription: \"enter link description here\",\n        linkdialog: \"<p><b>Insert Hyperlink</b></p><p>http://example.com/ \\\"optional title\\\"</p>\",\n        \n        quote: \"Blockquote <blockquote>\",\n        quoteexample: \"Blockquote\",\n        \n        code: \"Code Sample <pre><code>\",\n        codeexample: \"enter code here\",\n        \n        image: \"Image <img>\",\n        imagedescription: \"enter image description here\",\n        imagedialog: \"<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg \\\"optional title\\\"<br><br>Need <a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>free image hosting?</a></p>\",\n        \n        olist: \"Numbered List <ol>\",\n        ulist: \"Bulleted List <ul>\",\n        litem: \"List item\",\n        \n        heading: \"Heading <h1>/<h2>\",\n        headingexample: \"Heading\",\n        \n        hr: \"Horizontal Rule <hr>\",\n\n        table: \"Table <table>\",\n        \n        undo: \"Undo -\",\n        redo: \"Redo -\",\n        \n        help: \"Markdown Editing Help\"\n    };\n    \n    var keyStrokes = {\n        bold: {\n            win: 'Ctrl-B',\n            mac: 'Command-B|Ctrl-B',\n        },\n        italic: {\n            win: 'Ctrl-I',\n            mac: 'Command-I|Ctrl-I',\n        },\n        link: {\n            win: 'Ctrl-L',\n            mac: 'Command-L|Ctrl-L',\n        },\n        quote: {\n            win: 'Ctrl-Q',\n            mac: 'Command-Q|Ctrl-Q',\n        },\n        code: {\n            win: 'Ctrl-K',\n            mac: 'Command-K|Ctrl-K',\n        },\n        image: {\n            win: 'Ctrl-G',\n            mac: 'Command-G|Ctrl-G',\n        },\n        olist: {\n            win: 'Ctrl-O',\n            mac: 'Command-O|Ctrl-O',\n        },\n        ulist: {\n            win: 'Ctrl-U',\n            mac: 'Command-U|Ctrl-U',\n        },\n        heading: {\n            win: 'Ctrl-H',\n            mac: 'Command-H|Ctrl-H',\n        },\n        hr: {\n            win: 'Ctrl-R',\n            mac: 'Command-R|Ctrl-R',\n        },\n        table: {\n            win: 'Ctrl-T',\n            mac: 'Command-T|Ctrl-T'\n        },\n        undo: {\n            win: 'Ctrl-Z',\n            mac: 'Command-Z',\n        },\n        redo: {\n            win: 'Ctrl-Y|Ctrl-Shift-Z',\n            mac: 'Command-Y|Command-Shift-Z',\n        },\n    };\n\n\n    // -------------------------------------------------------------------\n    //  YOUR CHANGES GO HERE\n    //\n    // I've tried to localize the things you are likely to change to\n    // this area.\n    // -------------------------------------------------------------------\n\n    // The default text that appears in the dialog input box when entering\n    // links.\n    var imageDefaultText = \"http://\";\n    var linkDefaultText = \"http://\";\n\n    // -------------------------------------------------------------------\n    //  END OF YOUR CHANGES\n    // -------------------------------------------------------------------\n\n    // options, if given, can have the following properties:\n    //   options.helpButton = { handler: yourEventHandler }\n    //   options.strings = { italicexample: \"slanted text\" }\n    // `yourEventHandler` is the click handler for the help button.\n    // If `options.helpButton` isn't given, not help button is created.\n    // `options.strings` can have any or all of the same properties as\n    // `defaultStrings` above, so you can just override some string displayed\n    // to the user on a case-by-case basis, or translate all strings to\n    // a different language.\n    //\n    // For backwards compatibility reasons, the `options` argument can also\n    // be just the `helpButton` object, and `strings.help` can also be set via\n    // `helpButton.title`. This should be considered legacy.\n    //\n    // The constructed editor object has the methods:\n    // - getConverter() returns the markdown converter object that was passed to the constructor\n    // - run() actually starts the editor; should be called after all necessary plugins are registered. Calling this more than once is a no-op.\n    // - refreshPreview() forces the preview to be updated. This method is only available after run() was called.\n    Markdown.Editor = function (markdownConverter, idPostfix, options) {\n        \n        options = options || {};\n\n        if (typeof options.handler === \"function\") { //backwards compatible behavior\n            options = { helpButton: options };\n        }\n        options.strings = options.strings || {};\n        if (options.helpButton) {\n            options.strings.help = options.strings.help || options.helpButton.title;\n        }\n        // Override default keystrokes\n        if(options.keyStrokes) {\n            for(var key in options.keyStrokes) {\n                keyStrokes[key] = options.keyStrokes[key];\n            }\n        }\n        var getString = function (identifier) { return options.strings[identifier] || defaultsStrings[identifier]; }\n\n        idPostfix = idPostfix || \"\";\n\n        var hooks = this.hooks = new Markdown.HookCollection();\n        hooks.addNoop(\"onPreviewRefresh\");       // called with no arguments after the preview has been refreshed\n        hooks.addNoop(\"postBlockquoteCreation\"); // called with the user's selection *after* the blockquote was created; should return the actual to-be-inserted text\n        hooks.addFalse(\"insertImageDialog\");     /* called with one parameter: a callback to be called with the URL of the image. If the application creates\n                                                  * its own image insertion dialog, this hook should return true, and the callback should be called with the chosen\n                                                  * image url (or null if the user cancelled). If this hook returns false, the default dialog will be used.\n                                                  */\n        hooks.addFalse(\"insertLinkDialog\");\n\n        this.getConverter = function () { return markdownConverter; }\n\n        var that = this,\n            panels;\n\n        var undoManager;\n        this.run = function (cm, previewWrapper) {\n            if (panels)\n                return; // already initialized\n\n            panels = new PanelCollection(idPostfix, cm);\n            var commandManager = new CommandManager(hooks, getString);\n            var previewManager = new PreviewManager(markdownConverter, panels, function () { hooks.onPreviewRefresh(); }, previewWrapper);\n            var uiManager;\n\n            /*benweet\n            if (!/\\?noundo/.test(doc.location.href)) {\n                undoManager = new UndoManager(function () {\n                    previewManager.refresh();\n                    if (uiManager) // not available on the first call\n                        uiManager.setUndoRedoButtonStates();\n                }, panels);\n                this.textOperation = function (f) {\n                    undoManager.setCommandMode();\n                    f();\n                    that.refreshPreview();\n                }\n            }\n            */\n\n            var getKey = function (identifier) {\n                return keyStrokes[identifier][uaSniffed.isMac ? \"mac\" : \"win\"].split('|').join(' ');\n            };\n            uiManager = new UIManager(idPostfix, panels, undoManager, previewManager, commandManager, options.helpButton, getString, getKey);\n            uiManager.setUndoRedoButtonStates();\n\n            var forceRefresh = that.refreshPreview = function () { previewManager.refresh(true); };\n\n            forceRefresh();\n            that.uiManager = uiManager;\n        };\n\n    }\n\n    // before: contains all the text in the input box BEFORE the selection.\n    // after: contains all the text in the input box AFTER the selection.\n    function Chunks() { }\n\n    // startRegex: a regular expression to find the start tag\n    // endRegex: a regular expresssion to find the end tag\n    Chunks.prototype.findTags = function (startRegex, endRegex) {\n\n        var chunkObj = this;\n        var regex;\n\n        if (startRegex) {\n\n            regex = util.extendRegExp(startRegex, \"\", \"$\");\n\n            this.before = this.before.replace(regex,\n                function (match) {\n                    chunkObj.startTag = chunkObj.startTag + match;\n                    return \"\";\n                });\n\n            regex = util.extendRegExp(startRegex, \"^\", \"\");\n\n            this.selection = this.selection.replace(regex,\n                function (match) {\n                    chunkObj.startTag = chunkObj.startTag + match;\n                    return \"\";\n                });\n        }\n\n        if (endRegex) {\n\n            regex = util.extendRegExp(endRegex, \"\", \"$\");\n\n            this.selection = this.selection.replace(regex,\n                function (match) {\n                    chunkObj.endTag = match + chunkObj.endTag;\n                    return \"\";\n                });\n\n            regex = util.extendRegExp(endRegex, \"^\", \"\");\n\n            this.after = this.after.replace(regex,\n                function (match) {\n                    chunkObj.endTag = match + chunkObj.endTag;\n                    return \"\";\n                });\n        }\n    };\n\n    // If remove is false, the whitespace is transferred\n    // to the before/after regions.\n    //\n    // If remove is true, the whitespace disappears.\n    Chunks.prototype.trimWhitespace = function (remove) {\n        var beforeReplacer, afterReplacer, that = this;\n        if (remove) {\n            beforeReplacer = afterReplacer = \"\";\n        } else {\n            beforeReplacer = function (s) { that.before += s; return \"\"; }\n            afterReplacer = function (s) { that.after = s + that.after; return \"\"; }\n        }\n\n        this.selection = this.selection.replace(/^(\\s*)/, beforeReplacer).replace(/(\\s*)$/, afterReplacer);\n    };\n\n\n    Chunks.prototype.skipLines = function (nLinesBefore, nLinesAfter, findExtraNewlines) {\n\n        if (nLinesBefore === undefined) {\n            nLinesBefore = 1;\n        }\n\n        if (nLinesAfter === undefined) {\n            nLinesAfter = 1;\n        }\n\n        nLinesBefore++;\n        nLinesAfter++;\n\n        var regexText;\n        var replacementText;\n\n        // chrome bug ... documented at: http://meta.stackoverflow.com/questions/63307/blockquote-glitch-in-editor-in-chrome-6-and-7/65985#65985\n        if (navigator.userAgent.match(/Chrome/)) {\n            \"X\".match(/()./);\n        }\n\n        this.selection = this.selection.replace(/(^\\n*)/, \"\");\n\n        this.startTag = this.startTag + re.$1;\n\n        this.selection = this.selection.replace(/(\\n*$)/, \"\");\n        this.endTag = this.endTag + re.$1;\n        this.startTag = this.startTag.replace(/(^\\n*)/, \"\");\n        this.before = this.before + re.$1;\n        this.endTag = this.endTag.replace(/(\\n*$)/, \"\");\n        this.after = this.after + re.$1;\n\n        if (this.before) {\n\n            regexText = replacementText = \"\";\n\n            while (nLinesBefore--) {\n                regexText += \"\\\\n?\";\n                replacementText += \"\\n\";\n            }\n\n            if (findExtraNewlines) {\n                regexText = \"\\\\n*\";\n            }\n            this.before = this.before.replace(new re(regexText + \"$\", \"\"), replacementText);\n        }\n\n        if (this.after) {\n\n            regexText = replacementText = \"\";\n\n            while (nLinesAfter--) {\n                regexText += \"\\\\n?\";\n                replacementText += \"\\n\";\n            }\n            if (findExtraNewlines) {\n                regexText = \"\\\\n*\";\n            }\n\n            this.after = this.after.replace(new re(regexText, \"\"), replacementText);\n        }\n    };\n\n    // end of Chunks\n\n    // A collection of the important regions on the page.\n    // Cached so we don't have to keep traversing the DOM.\n    // Also holds ieCachedRange and ieCachedScrollTop, where necessary; working around\n    // this issue:\n    // Internet explorer has problems with CSS sprite buttons that use HTML\n    // lists.  When you click on the background image \"button\", IE will\n    // select the non-existent link text and discard the selection in the\n    // textarea.  The solution to this is to cache the textarea selection\n    // on the button's mousedown event and set a flag.  In the part of the\n    // code where we need to grab the selection, we check for the flag\n    // and, if it's set, use the cached area instead of querying the\n    // textarea.\n    //\n    // This ONLY affects Internet Explorer (tested on versions 6, 7\n    // and 8) and ONLY on button clicks.  Keyboard shortcuts work\n    // normally since the focus never leaves the textarea.\n    function PanelCollection(postfix, cm) {\n        this.buttonBar = doc.getElementById(\"wmd-button-bar\" + postfix);\n        this.preview = doc.getElementById(\"wmd-preview\" + postfix);\n        this.input = cm;\n    };\n\n    // Returns true if the DOM element is visible, false if it's hidden.\n    // Checks if display is anything other than none.\n    util.isVisible = function (elem) {\n\n        if (window.getComputedStyle) {\n            // Most browsers\n            return window.getComputedStyle(elem, null).getPropertyValue(\"display\") !== \"none\";\n        }\n        else if (elem.currentStyle) {\n            // IE\n            return elem.currentStyle[\"display\"] !== \"none\";\n        }\n    };\n\n\n    // Adds a listener callback to a DOM element which is fired on a specified\n    // event.\n    util.addEvent = function (elem, event, listener) {\n        if (elem.attachEvent) {\n            // IE only.  The \"on\" is mandatory.\n            elem.attachEvent(\"on\" + event, listener);\n        }\n        else {\n            // Other browsers.\n            elem.addEventListener(event, listener, false);\n        }\n    };\n\n\n    // Removes a listener callback from a DOM element which is fired on a specified\n    // event.\n    util.removeEvent = function (elem, event, listener) {\n        if (elem.detachEvent) {\n            // IE only.  The \"on\" is mandatory.\n            elem.detachEvent(\"on\" + event, listener);\n        }\n        else {\n            // Other browsers.\n            elem.removeEventListener(event, listener, false);\n        }\n    };\n\n    // Converts \\r\\n and \\r to \\n.\n    util.fixEolChars = function (text) {\n        text = text.replace(/\\r\\n/g, \"\\n\");\n        text = text.replace(/\\r/g, \"\\n\");\n        return text;\n    };\n\n    // Extends a regular expression.  Returns a new RegExp\n    // using pre + regex + post as the expression.\n    // Used in a few functions where we have a base\n    // expression and we want to pre- or append some\n    // conditions to it (e.g. adding \"$\" to the end).\n    // The flags are unchanged.\n    //\n    // regex is a RegExp, pre and post are strings.\n    util.extendRegExp = function (regex, pre, post) {\n\n        if (pre === null || pre === undefined) {\n            pre = \"\";\n        }\n        if (post === null || post === undefined) {\n            post = \"\";\n        }\n\n        var pattern = regex.toString();\n        var flags;\n\n        // Replace the flags with empty space and store them.\n        pattern = pattern.replace(/\\/([gim]*)$/, function (wholeMatch, flagsPart) {\n            flags = flagsPart;\n            return \"\";\n        });\n\n        // Remove the slash delimiters on the regular expression.\n        pattern = pattern.replace(/(^\\/|\\/$)/g, \"\");\n        pattern = pre + pattern + post;\n\n        return new re(pattern, flags);\n    }\n\n    // UNFINISHED\n    // The assignment in the while loop makes jslint cranky.\n    // I'll change it to a better loop later.\n    position.getTop = function (elem, isInner) {\n        var result = elem.offsetTop;\n        if (!isInner) {\n            while (elem = elem.offsetParent) {\n                result += elem.offsetTop;\n            }\n        }\n        return result;\n    };\n\n    position.getHeight = function (elem) {\n        return elem.offsetHeight || elem.scrollHeight;\n    };\n\n    position.getWidth = function (elem) {\n        return elem.offsetWidth || elem.scrollWidth;\n    };\n\n    position.getPageSize = function () {\n\n        var scrollWidth, scrollHeight;\n        var innerWidth, innerHeight;\n\n        // It's not very clear which blocks work with which browsers.\n        if (this.innerHeight && this.scrollMaxY) {\n            scrollWidth = doc.body.scrollWidth;\n            scrollHeight = this.innerHeight + this.scrollMaxY;\n        }\n        else if (doc.body.scrollHeight > doc.body.offsetHeight) {\n            scrollWidth = doc.body.scrollWidth;\n            scrollHeight = doc.body.scrollHeight;\n        }\n        else {\n            scrollWidth = doc.body.offsetWidth;\n            scrollHeight = doc.body.offsetHeight;\n        }\n\n        if (this.innerHeight) {\n            // Non-IE browser\n            innerWidth = this.innerWidth;\n            innerHeight = this.innerHeight;\n        }\n        else if (doc.documentElement && doc.documentElement.clientHeight) {\n            // Some versions of IE (IE 6 w/ a DOCTYPE declaration)\n            innerWidth = doc.documentElement.clientWidth;\n            innerHeight = doc.documentElement.clientHeight;\n        }\n        else if (doc.body) {\n            // Other versions of IE\n            innerWidth = doc.body.clientWidth;\n            innerHeight = doc.body.clientHeight;\n        }\n\n        var maxWidth = Math.max(scrollWidth, innerWidth);\n        var maxHeight = Math.max(scrollHeight, innerHeight);\n        return [maxWidth, maxHeight, innerWidth, innerHeight];\n    };\n\n    /*benweet\n    // Handles pushing and popping TextareaStates for undo/redo commands.\n    // I should rename the stack variables to list.\n    function UndoManager(callback, panels) {\n\n        var undoObj = this;\n        var undoStack = []; // A stack of undo states\n        var stackPtr = 0; // The index of the current state\n        var mode = \"none\";\n        var lastState; // The last state\n        var timer; // The setTimeout handle for cancelling the timer\n        var inputStateObj;\n\n        // Set the mode for later logic steps.\n        var setMode = function (newMode, noSave) {\n            if (mode != newMode) {\n                mode = newMode;\n                if (!noSave) {\n                    saveState();\n                }\n            }\n\n            if (!uaSniffed.isIE || mode != \"moving\") {\n                timer = setTimeout(refreshState, 1);\n            }\n            else {\n                inputStateObj = null;\n            }\n        };\n\n        var refreshState = function (isInitialState) {\n            inputStateObj = new TextareaState(panels, isInitialState);\n            timer = undefined;\n        };\n\n        this.setCommandMode = function () {\n            mode = \"command\";\n            saveState();\n            timer = setTimeout(refreshState, 0);\n        };\n\n        this.canUndo = function () {\n            return stackPtr > 1;\n        };\n\n        this.canRedo = function () {\n            if (undoStack[stackPtr + 1]) {\n                return true;\n            }\n            return false;\n        };\n\n        // Removes the last state and restores it.\n        this.undo = function () {\n\n            if (undoObj.canUndo()) {\n                if (lastState) {\n                    // What about setting state -1 to null or checking for undefined?\n                    lastState.restore();\n                    lastState = null;\n                }\n                else {\n                    undoStack[stackPtr] = new TextareaState(panels);\n                    undoStack[--stackPtr].restore();\n\n                    if (callback) {\n                        callback();\n                    }\n                }\n            }\n\n            mode = \"none\";\n            panels.input.focus();\n            refreshState();\n        };\n\n        // Redo an action.\n        this.redo = function () {\n\n            if (undoObj.canRedo()) {\n\n                undoStack[++stackPtr].restore();\n\n                if (callback) {\n                    callback();\n                }\n            }\n\n            mode = \"none\";\n            panels.input.focus();\n            refreshState();\n        };\n\n        // Push the input area state to the stack.\n        var saveState = function () {\n            var currState = inputStateObj || new TextareaState(panels);\n\n            if (!currState) {\n                return false;\n            }\n            if (mode == \"moving\") {\n                if (!lastState) {\n                    lastState = currState;\n                }\n                return;\n            }\n            if (lastState) {\n                if (undoStack[stackPtr - 1].text != lastState.text) {\n                    undoStack[stackPtr++] = lastState;\n                }\n                lastState = null;\n            }\n            undoStack[stackPtr++] = currState;\n            undoStack[stackPtr + 1] = null;\n            if (callback) {\n                callback();\n            }\n        };\n\n        var handleCtrlYZ = function (event) {\n\n            var handled = false;\n\n            if ((event.ctrlKey || event.metaKey) && !event.altKey) {\n\n                // IE and Opera do not support charCode.\n                var keyCode = event.charCode || event.keyCode;\n                var keyCodeChar = String.fromCharCode(keyCode);\n\n                switch (keyCodeChar.toLowerCase()) {\n\n                    case \"y\":\n                        undoObj.redo();\n                        handled = true;\n                        break;\n\n                    case \"z\":\n                        if (!event.shiftKey) {\n                            undoObj.undo();\n                        }\n                        else {\n                            undoObj.redo();\n                        }\n                        handled = true;\n                        break;\n                }\n            }\n\n            if (handled) {\n                if (event.preventDefault) {\n                    event.preventDefault();\n                }\n                if (window.event) {\n                    window.event.returnValue = false;\n                }\n                return;\n            }\n        };\n\n        // Set the mode depending on what is going on in the input area.\n        var handleModeChange = function (event) {\n\n            if (!event.ctrlKey && !event.metaKey) {\n\n                var keyCode = event.keyCode;\n\n                if ((keyCode >= 33 && keyCode <= 40) || (keyCode >= 63232 && keyCode <= 63235)) {\n                    // 33 - 40: page up/dn and arrow keys\n                    // 63232 - 63235: page up/dn and arrow keys on safari\n                    setMode(\"moving\");\n                }\n                else if (keyCode == 8 || keyCode == 46 || keyCode == 127) {\n                    // 8: backspace\n                    // 46: delete\n                    // 127: delete\n                    setMode(\"deleting\");\n                }\n                else if (keyCode == 13) {\n                    // 13: Enter\n                    setMode(\"newlines\");\n                }\n                else if (keyCode == 27) {\n                    // 27: escape\n                    setMode(\"escape\");\n                }\n                else if ((keyCode < 16 || keyCode > 20) && keyCode != 91) {\n                    // 16-20 are shift, etc.\n                    // 91: left window key\n                    // I think this might be a little messed up since there are\n                    // a lot of nonprinting keys above 20.\n                    setMode(\"typing\");\n                }\n            }\n        };\n\n        var setEventHandlers = function () {\n            util.addEvent(panels.input, \"keypress\", function (event) {\n                // keyCode 89: y\n                // keyCode 90: z\n                if ((event.ctrlKey || event.metaKey) && !event.altKey && (event.keyCode == 89 || event.keyCode == 90)) {\n                    event.preventDefault();\n                }\n            });\n\n            var handlePaste = function () {\n                if (uaSniffed.isIE || (inputStateObj && inputStateObj.text != panels.input.value)) {\n                    if (timer == undefined) {\n                        mode = \"paste\";\n                        saveState();\n                        refreshState();\n                    }\n                }\n            };\n\n            //util.addEvent(panels.input, \"keydown\", handleCtrlYZ);\n            util.addEvent(panels.input, \"keydown\", handleModeChange);\n            util.addEvent(panels.input, \"mousedown\", function () {\n                setMode(\"moving\");\n            });\n\n            panels.input.onpaste = handlePaste;\n            panels.input.ondrop = handlePaste;\n        };\n\n        var init = function () {\n            setEventHandlers();\n            refreshState(true);\n            //Not necessary\n            //saveState();\n        };\n        \n        this.reinit = function(content, start, end, scrollTop) {\n            undoStack = [];\n            stackPtr = 0;\n            mode = \"none\";\n            lastState = undefined;\n            timer = undefined;\n            refreshState();\n            inputStateObj.text = content;\n            inputStateObj.start = start;\n            inputStateObj.end = end;\n            inputStateObj.scrollTop = scrollTop;\n            inputStateObj.setInputAreaSelection();\n            saveState();\n        };\n        this.setMode = setMode;\n\n        init();\n    }\n\n    // end of UndoManager\n    */\n\n    // The input textarea state/contents.\n    // This is used to implement undo/redo by the undo manager.\n    function TextareaState(panels, isInitialState) {\n\n        // Aliases\n        var stateObj = this;\n        var inputArea = panels.input;\n        this.init = function () {\n            /*benweet\n            if (!util.isVisible(inputArea)) {\n                return;\n            }\n            if (!isInitialState && doc.activeElement && doc.activeElement !== inputArea) { // this happens when tabbing out of the input box\n                return;\n            }\n            */\n\n            (function() {\n                stateObj.before = inputArea.doc.getRange(CodeMirror.Pos(0,0),inputArea.doc.getCursor(\"from\"));\n                stateObj.selection = inputArea.doc.getSelection();\n                stateObj.after = inputArea.doc.getRange(inputArea.doc.getCursor(\"to\"),inputArea.doc.posFromIndex(Number.MAX_VALUE));\n            })();\n            this.text = [this.before, this.selection, this.after].join('');\n            this.length = this.text.length;\n            this.setInputAreaSelectionStartEnd();\n            this.scrollTop = inputArea.doc.scrollTop || 0;\n            /*benweet\n            if (!this.text && inputArea.selectionStart || inputArea.selectionStart === 0) {\n                this.text = inputArea.value;\n            }\n            */\n        }\n\n        // Sets the selected text in the input box after we've performed an\n        // operation.\n        this.setInputAreaSelection = function () {\n\n            inputArea.doc.setSelection(inputArea.doc.posFromIndex(stateObj.start),inputArea.doc.posFromIndex(stateObj.end),{scroll:true});\n            inputArea.focus();\n            \n            /*benweet\n            if (!util.isVisible(inputArea)) {\n                return;\n            }\n\n            if (inputArea.selectionStart !== undefined && !uaSniffed.isOpera) {\n\n                inputArea.focus();\n                inputArea.selectionStart = stateObj.start;\n                inputArea.selectionEnd = stateObj.end;\n                inputArea.scrollTop = stateObj.scrollTop;\n            }\n            else if (doc.selection) {\n\n                if (doc.activeElement && doc.activeElement !== inputArea) {\n                    return;\n                }\n\n                inputArea.focus();\n                var range = inputArea.createTextRange();\n                range.moveStart(\"character\", -inputArea.value.length);\n                range.moveEnd(\"character\", -inputArea.value.length);\n                range.moveEnd(\"character\", stateObj.end);\n                range.moveStart(\"character\", stateObj.start);\n                range.select();\n            }\n            */\n        };\n\n        this.setInputAreaSelectionStartEnd = function () {\n            \n            stateObj.start = stateObj.before.length;\n            stateObj.end = stateObj.after.length;\n            \n            /*benweet\n            if (!panels.ieCachedRange && (inputArea.selectionStart || inputArea.selectionStart === 0)) {\n\n                stateObj.start = inputArea.selectionStart;\n                stateObj.end = inputArea.selectionEnd;\n            }\n            else if (doc.selection) {\n\n                stateObj.text = util.fixEolChars(inputArea.value);\n\n                // IE loses the selection in the textarea when buttons are\n                // clicked.  On IE we cache the selection. Here, if something is cached,\n                // we take it.\n                var range = panels.ieCachedRange || doc.selection.createRange();\n\n                var fixedRange = util.fixEolChars(range.text);\n                var marker = \"\\x07\";\n                var markedRange = marker + fixedRange + marker;\n                range.text = markedRange;\n                var inputText = util.fixEolChars(inputArea.value);\n\n                range.moveStart(\"character\", -markedRange.length);\n                range.text = fixedRange;\n\n                stateObj.start = inputText.indexOf(marker);\n                stateObj.end = inputText.lastIndexOf(marker) - marker.length;\n\n                var len = stateObj.text.length - util.fixEolChars(inputArea.value).length;\n\n                if (len) {\n                    range.moveStart(\"character\", -fixedRange.length);\n                    while (len--) {\n                        fixedRange += \"\\n\";\n                        stateObj.end += 1;\n                    }\n                    range.text = fixedRange;\n                }\n\n                if (panels.ieCachedRange)\n                    stateObj.scrollTop = panels.ieCachedScrollTop; // this is set alongside with ieCachedRange\n\n                panels.ieCachedRange = null;\n\n                this.setInputAreaSelection();\n            }\n            */\n        };\n\n        // Restore this state into the input area.\n        this.restore = function () {\n            // Here we could do editor.setValue but we want to update the less we can for undo management\n            \n            // Find the first modified char\n            var startIndex = 0;\n            var startIndexMax = stateObj.before.length; \n            while(startIndex < startIndexMax) {\n                if(stateObj.before.charCodeAt(startIndex) !== stateObj.text.charCodeAt(startIndex))\n                    break;\n                startIndex++;\n            }\n            // Find the last modified char\n            var endIndex = 0;\n            var endIndexMax = stateObj.after.length;\n            var beforeMaxOffset = stateObj.after.length - 1;\n            var afterMaxOffset = stateObj.text.length - 1;\n            while(endIndex < endIndexMax) {\n                if(stateObj.after.charCodeAt(beforeMaxOffset - endIndex) !== stateObj.text.charCodeAt(afterMaxOffset - endIndex))\n                    break;\n                endIndex++;\n            }\n            \n            inputArea.doc.replaceRange(stateObj.text.substring(startIndex, afterMaxOffset - endIndex + 1),\n                inputArea.doc.posFromIndex(startIndex),\n                inputArea.doc.posFromIndex(stateObj.length - endIndex)\n            );\n            this.setInputAreaSelection();\n\n            /*benweet\n            if (stateObj.text != undefined && stateObj.text != inputArea.value) {\n                inputArea.value = stateObj.text;\n            }\n            inputArea.scrollTop = stateObj.scrollTop;\n            */\n        };\n\n        // Gets a collection of HTML chunks from the inptut textarea.\n        this.getChunks = function () {\n\n            var chunk = new Chunks();\n            chunk.before = stateObj.before;\n            chunk.startTag = \"\";\n            chunk.selection = stateObj.selection;\n            chunk.endTag = \"\";\n            chunk.after = stateObj.after;\n            chunk.scrollTop = stateObj.scrollTop;\n\n            return chunk;\n        };\n\n        // Sets the TextareaState properties given a chunk of markdown.\n        this.setChunks = function (chunk) {\n\n            chunk.before = chunk.before + chunk.startTag;\n            chunk.after = chunk.endTag + chunk.after;\n\n            this.start = chunk.before.length;\n            this.end = chunk.before.length + chunk.selection.length;\n            this.text = chunk.before + chunk.selection + chunk.after;\n            this.scrollTop = chunk.scrollTop;\n        };\n        this.init();\n    };\n\n    function PreviewManager(converter, panels, previewRefreshCallback, previewWrapper) {\n\n        var managerObj = this;\n        var timeout;\n        var elapsedTime;\n        var oldInputText;\n        var maxDelay = 3000;\n        var startType = \"delayed\"; // The other legal value is \"manual\"\n\n        // Adds event listeners to elements\n        /*benweet\n        var setupEvents = function (inputElem, listener) {\n\n            util.addEvent(inputElem, \"input\", listener);\n            inputElem.onpaste = listener;\n            inputElem.ondrop = listener;\n\n            util.addEvent(inputElem, \"keypress\", listener);\n            util.addEvent(inputElem, \"keydown\", listener);\n        };\n        */\n\n        var getDocScrollTop = function () {\n\n            var result = 0;\n\n            if (window.innerHeight) {\n                result = window.pageYOffset;\n            }\n            else\n                if (doc.documentElement && doc.documentElement.scrollTop) {\n                    result = doc.documentElement.scrollTop;\n                }\n                else\n                    if (doc.body) {\n                        result = doc.body.scrollTop;\n                    }\n\n            return result;\n        };\n\n        var makePreviewHtml = function () {\n\n            // If there is no registered preview panel\n            // there is nothing to do.\n            if (!panels.preview)\n                return;\n\n\n            var text = panels.input.doc.getValue();\n            if (text && text == oldInputText) {\n                return; // Input text hasn't changed.\n            }\n            else {\n                oldInputText = text;\n            }\n\n            var prevTime = new Date().getTime();\n\n            text = converter.makeHtml(text);\n\n            // Calculate the processing time of the HTML creation.\n            // It's used as the delay time in the event listener.\n            var currTime = new Date().getTime();\n            elapsedTime = currTime - prevTime;\n\n            pushPreviewHtml(text);\n        };\n        if(previewWrapper !== undefined) {\n            makePreviewHtml = previewWrapper(makePreviewHtml);\n        }\n\n        // setTimeout is already used.  Used as an event listener.\n        var applyTimeout = function () {\n\n            if (timeout) {\n                clearTimeout(timeout);\n                timeout = undefined;\n            }\n\n            if (startType !== \"manual\") {\n\n                var delay = 0;\n\n                if (startType === \"delayed\") {\n                    delay = elapsedTime;\n                }\n\n                if (delay > maxDelay) {\n                    delay = maxDelay;\n                }\n                timeout = setTimeout(makePreviewHtml, delay);\n            }\n        };\n\n        var getScaleFactor = function (panel) {\n            if (panel.scrollHeight <= panel.clientHeight) {\n                return 1;\n            }\n            return panel.scrollTop / (panel.scrollHeight - panel.clientHeight);\n        };\n\n        var setPanelScrollTops = function () {\n            if (panels.preview) {\n                panels.preview.scrollTop = (panels.preview.scrollHeight - panels.preview.clientHeight) * getScaleFactor(panels.preview);\n            }\n        };\n\n        this.refresh = function (requiresRefresh) {\n\n            if (requiresRefresh) {\n                oldInputText = \"\";\n                makePreviewHtml();\n            }\n            else {\n                applyTimeout();\n            }\n        };\n\n        this.processingTime = function () {\n            return elapsedTime;\n        };\n\n        var isFirstTimeFilled = true;\n\n        // IE doesn't let you use innerHTML if the element is contained somewhere in a table\n        // (which is the case for inline editing) -- in that case, detach the element, set the\n        // value, and reattach. Yes, that *is* ridiculous.\n        var ieSafePreviewSet = function (text) {\n            var preview = panels.preview;\n            var parent = preview.parentNode;\n            var sibling = preview.nextSibling;\n            parent.removeChild(preview);\n            preview.innerHTML = text;\n            if (!sibling)\n                parent.appendChild(preview);\n            else\n                parent.insertBefore(preview, sibling);\n        }\n\n        var nonSuckyBrowserPreviewSet = function (text) {\n            panels.preview.innerHTML = text;\n        }\n\n        var previewSetter;\n\n        var previewSet = function (text) {\n            if (previewSetter)\n                return previewSetter(text);\n\n            try {\n                nonSuckyBrowserPreviewSet(text);\n                previewSetter = nonSuckyBrowserPreviewSet;\n            } catch (e) {\n                previewSetter = ieSafePreviewSet;\n                previewSetter(text);\n            }\n        };\n\n        var pushPreviewHtml = function (text) {\n\n            var emptyTop = position.getTop(panels.input.doc) - getDocScrollTop();\n\n            if (panels.preview) {\n                previewSet(text);\n                previewRefreshCallback();\n            }\n\n            setPanelScrollTops();\n\n            if (isFirstTimeFilled) {\n                isFirstTimeFilled = false;\n                return;\n            }\n\n            var fullTop = position.getTop(panels.input.doc) - getDocScrollTop();\n\n            if (uaSniffed.isIE) {\n                setTimeout(function () {\n                    window.scrollBy(0, fullTop - emptyTop);\n                }, 0);\n            }\n            else {\n                window.scrollBy(0, fullTop - emptyTop);\n            }\n        };\n\n        var init = function () {\n\n            /*benweet\n            setupEvents(panels.input, applyTimeout);\n            */\n            panels.input.on('change', applyTimeout);\n            //Not necessary\n            //makePreviewHtml();\n\n            if (panels.preview) {\n                panels.preview.scrollTop = 0;\n            }\n        };\n\n        init();\n    };\n\n    // Creates the background behind the hyperlink text entry box.\n    // And download dialog\n    // Most of this has been moved to CSS but the div creation and\n    // browser-specific hacks remain here.\n    ui.createBackground = function () {\n\n        var background = doc.createElement(\"div\"),\n            style = background.style;\n        \n        background.className = \"wmd-prompt-background\";\n        \n        style.position = \"absolute\";\n        style.top = \"0\";\n\n        style.zIndex = \"1000\";\n\n        if (uaSniffed.isIE) {\n            style.filter = \"alpha(opacity=50)\";\n        }\n        else {\n            style.opacity = \"0.5\";\n        }\n\n        var pageSize = position.getPageSize();\n        style.height = pageSize[1] + \"px\";\n\n        if (uaSniffed.isIE) {\n            style.left = doc.documentElement.scrollLeft;\n            style.width = doc.documentElement.clientWidth;\n        }\n        else {\n            style.left = \"0\";\n            style.width = \"100%\";\n        }\n\n        doc.body.appendChild(background);\n        return background;\n    };\n\n    // This simulates a modal dialog box and asks for the URL when you\n    // click the hyperlink or image buttons.\n    //\n    // text: The html for the input box.\n    // defaultInputText: The default value that appears in the input box.\n    // callback: The function which is executed when the prompt is dismissed, either via OK or Cancel.\n    //      It receives a single argument; either the entered text (if OK was chosen) or null (if Cancel\n    //      was chosen).\n    ui.prompt = function (text, defaultInputText, callback) {\n\n        // These variables need to be declared at this level since they are used\n        // in multiple functions.\n        var dialog;         // The dialog box.\n        var input;         // The text box where you enter the hyperlink.\n\n\n        if (defaultInputText === undefined) {\n            defaultInputText = \"\";\n        }\n\n        // Used as a keydown event handler. Esc dismisses the prompt.\n        // Key code 27 is ESC.\n        var checkEscape = function (key) {\n            var code = (key.charCode || key.keyCode);\n            if (code === 27) {\n                close(true);\n            }\n        };\n\n        // Dismisses the hyperlink input box.\n        // isCancel is true if we don't care about the input text.\n        // isCancel is false if we are going to keep the text.\n        var close = function (isCancel) {\n            util.removeEvent(doc.body, \"keydown\", checkEscape);\n            var text = input.value;\n\n            if (isCancel) {\n                text = null;\n            }\n            else {\n                // Fixes common pasting errors.\n                text = text.replace(/^http:\\/\\/(https?|ftp):\\/\\//, '$1://');\n                if (!/^(?:https?|ftp):\\/\\//.test(text))\n                    text = 'http://' + text;\n            }\n\n            dialog.parentNode.removeChild(dialog);\n\n            callback(text);\n            return false;\n        };\n\n\n\n        // Create the text input box form/window.\n        var createDialog = function () {\n\n            // The main dialog box.\n            dialog = doc.createElement(\"div\");\n            dialog.className = \"wmd-prompt-dialog\";\n            dialog.style.padding = \"10px;\";\n            dialog.style.position = \"fixed\";\n            dialog.style.width = \"400px\";\n            dialog.style.zIndex = \"1001\";\n\n            // The dialog text.\n            var question = doc.createElement(\"div\");\n            question.innerHTML = text;\n            question.style.padding = \"5px\";\n            dialog.appendChild(question);\n\n            // The web form container for the text box and buttons.\n            var form = doc.createElement(\"form\"),\n                style = form.style;\n            form.onsubmit = function () { return close(false); };\n            style.padding = \"0\";\n            style.margin = \"0\";\n            style.cssFloat = \"left\";\n            style.width = \"100%\";\n            style.textAlign = \"center\";\n            style.position = \"relative\";\n            dialog.appendChild(form);\n\n            // The input text box\n            input = doc.createElement(\"input\");\n            input.type = \"text\";\n            input.value = defaultInputText;\n            style = input.style;\n            style.display = \"block\";\n            style.width = \"80%\";\n            style.marginLeft = style.marginRight = \"auto\";\n            form.appendChild(input);\n\n            // The ok button\n            var okButton = doc.createElement(\"input\");\n            okButton.type = \"button\";\n            okButton.onclick = function () { return close(false); };\n            okButton.value = \"OK\";\n            style = okButton.style;\n            style.margin = \"10px\";\n            style.display = \"inline\";\n            style.width = \"7em\";\n\n\n            // The cancel button\n            var cancelButton = doc.createElement(\"input\");\n            cancelButton.type = \"button\";\n            cancelButton.onclick = function () { return close(true); };\n            cancelButton.value = \"Cancel\";\n            style = cancelButton.style;\n            style.margin = \"10px\";\n            style.display = \"inline\";\n            style.width = \"7em\";\n\n            form.appendChild(okButton);\n            form.appendChild(cancelButton);\n\n            util.addEvent(doc.body, \"keydown\", checkEscape);\n            dialog.style.top = \"50%\";\n            dialog.style.left = \"50%\";\n            dialog.style.display = \"block\";\n            if (uaSniffed.isIE_5or6) {\n                dialog.style.position = \"absolute\";\n                dialog.style.top = doc.documentElement.scrollTop + 200 + \"px\";\n                dialog.style.left = \"50%\";\n            }\n            doc.body.appendChild(dialog);\n\n            // This has to be done AFTER adding the dialog to the form if you\n            // want it to be centered.\n            dialog.style.marginTop = -(position.getHeight(dialog) / 2) + \"px\";\n            dialog.style.marginLeft = -(position.getWidth(dialog) / 2) + \"px\";\n\n        };\n\n        // Why is this in a zero-length timeout?\n        // Is it working around a browser bug?\n        setTimeout(function () {\n\n            createDialog();\n\n            /*var defTextLen = defaultInputText.length;\n            if (input.selectionStart !== undefined) {\n                input.selectionStart = 0;\n                input.selectionEnd = defTextLen;\n            }\n            else if (input.createTextRange) {\n                var range = input.createTextRange();\n                range.collapse(false);\n                range.moveStart(\"character\", -defTextLen);\n                range.moveEnd(\"character\", defTextLen);\n                range.select();\n            }*/\n\n            input.focus();\n        }, 0);\n    };\n\n    function UIManager(postfix, panels, undoManager, previewManager, commandManager, helpOptions, getString, getKey) {\n        var getStringAndKey = function (identifier) { return getString(identifier) + ' ' + getKey(identifier); };\n\n        var inputBox = panels.input,\n            buttons = {}; // buttons.undo, buttons.link, etc. The actual DOM elements.\n\n        this.setUndoRedoButtonStates = function() {\n            setTimeout(function() {\n                setupButton(buttons.undo, inputBox.doc.history.done.length > 0);\n                setupButton(buttons.redo, inputBox.doc.history.undone.length > 0);\n            }, 50);\n        };\n\n        var that = this;\n        makeSpritedButtonRow();\n\n        var keyEvent = \"keydown\";\n        if (uaSniffed.isOpera) {\n            keyEvent = \"keypress\";\n        }\n\n        function addKeyCmd(identifierList) {\n            if(identifierList.length === 0) {\n                return;\n            }\n            var eKeys = {};\n            for(var i=identifierList.length-1; i>=0; i--)\n            {\n                var identifier = identifierList[i];\n                eKeys[getKey(identifier)] = (function(identifier){\n                    return function(editor) { doClick(buttons[identifier]); };\n                })(identifier);\n            }\n            inputBox.addKeyMap(eKeys);\n        };\n        addKeyCmd(['bold', 'italic', 'link', 'quote', 'code', 'image', 'olist', 'ulist', 'heading', 'hr', 'table']);\n        \n        /*benweet\n        util.addEvent(inputBox, keyEvent, function (key) {\n\n            // Check to see if we have a button key and, if so execute the callback.\n            if ((key.ctrlKey || key.metaKey) && !key.altKey) {\n\n                var keyCode = key.charCode || key.keyCode;\n                var keyCodeStr = String.fromCharCode(keyCode).toLowerCase();\n\n                switch (keyCodeStr) {\n                    case \"b\":\n                        doClick(buttons.bold);\n                        break;\n                    case \"i\":\n                        doClick(buttons.italic);\n                        break;\n                    case \"l\":\n                        doClick(buttons.link);\n                        break;\n                    case \"q\":\n                        doClick(buttons.quote);\n                        break;\n                    case \"k\":\n                        doClick(buttons.code);\n                        break;\n                    case \"g\":\n                        doClick(buttons.image);\n                        break;\n                    case \"o\":\n                        doClick(buttons.olist);\n                        break;\n                    case \"u\":\n                        doClick(buttons.ulist);\n                        break;\n                    case \"h\":\n                        doClick(buttons.heading);\n                        break;\n                    case \"r\":\n                        doClick(buttons.hr);\n                        break;\n                    case \"y\":\n                        doClick(buttons.redo);\n                        break;\n                    case \"z\":\n                        if (key.shiftKey) {\n                            doClick(buttons.redo);\n                        }\n                        else {\n                            doClick(buttons.undo);\n                        }\n                        break;\n                    case \"v\":\n                        undoManager.setMode(\"typing\");\n                        return;\n                    case \"x\":\n                        undoManager.setMode(\"deleting\");\n                        return;\n                    default:\n                        return;\n                }\n\n\n                if (key.preventDefault) {\n                    key.preventDefault();\n                }\n\n                if (window.event) {\n                    window.event.returnValue = false;\n                }\n            }\n        });\n\n        // Auto-indent on shift-enter\n        util.addEvent(inputBox, \"keyup\", function (key) {\n            if (key.shiftKey && !key.ctrlKey && !key.metaKey) {\n                var keyCode = key.charCode || key.keyCode;\n                // Character 13 is Enter\n                if (keyCode === 13) {\n                    var fakeButton = {};\n                    fakeButton.textOp = bindCommand(\"doAutoindent\");\n                    doClick(fakeButton);\n                }\n            }\n        });\n\n        // special handler because IE clears the context of the textbox on ESC\n        if (uaSniffed.isIE) {\n            util.addEvent(inputBox, \"keydown\", function (key) {\n                var code = key.keyCode;\n                if (code === 27) {\n                    return false;\n                }\n            });\n        }\n        */\n\n\n        // Perform the button's action.\n        function doClick(button) {\n\n            inputBox.focus();\n            var linkOrImage = button.id == \"wmd-link-button\" || button.id == \"wmd-image-button\";\n\n            if (button.textOp) {\n\n                if (undoManager && !linkOrImage) {\n                    undoManager.setCommandMode();\n                }\n\n                var state = new TextareaState(panels);\n\n                if (!state) {\n                    return;\n                }\n\n                var chunks = state.getChunks();\n\n                // Some commands launch a \"modal\" prompt dialog.  Javascript\n                // can't really make a modal dialog box and the WMD code\n                // will continue to execute while the dialog is displayed.\n                // This prevents the dialog pattern I'm used to and means\n                // I can't do something like this:\n                //\n                // var link = CreateLinkDialog();\n                // makeMarkdownLink(link);\n                //\n                // Instead of this straightforward method of handling a\n                // dialog I have to pass any code which would execute\n                // after the dialog is dismissed (e.g. link creation)\n                // in a function parameter.\n                //\n                // Yes this is awkward and I think it sucks, but there's\n                // no real workaround.  Only the image and link code\n                // create dialogs and require the function pointers.\n                var fixupInputArea = function () {\n\n                    inputBox.focus();\n\n                    if (chunks) {\n                        state.setChunks(chunks);\n                    }\n\n                    state.restore();\n                    previewManager.refresh();\n                };\n\n                var noCleanup = button.textOp(chunks, fixupInputArea);\n\n                if (!noCleanup) {\n                    fixupInputArea();\n                    /*benweet\n                    if(!linkOrImage) {\n                        inputBox.dispatchEvent(new Event('input'));\n                    }\n                    */\n                }\n\n            }\n\n            if (button.execute) {\n                button.execute(undoManager);\n            }\n        };\n\n        function setupButton(button, isEnabled) {\n\n            var normalYShift = \"0px\";\n            var disabledYShift = \"-20px\";\n            var highlightYShift = \"-40px\";\n            var image = button.getElementsByTagName(\"span\")[0];\n            button.className = button.className.replace(/ disabled/g, \"\");\n            if (isEnabled) {\n                image.style.backgroundPosition = button.XShift + \" \" + normalYShift;\n                button.onmouseover = function () {\n                    image.style.backgroundPosition = this.XShift + \" \" + highlightYShift;\n                };\n\n                button.onmouseout = function () {\n                    image.style.backgroundPosition = this.XShift + \" \" + normalYShift;\n                };\n\n                // IE tries to select the background image \"button\" text (it's\n                // implemented in a list item) so we have to cache the selection\n                // on mousedown.\n                if (uaSniffed.isIE) {\n                    button.onmousedown = function () {\n                        if (doc.activeElement && doc.activeElement !== panels.input.doc) { // we're not even in the input box, so there's no selection\n                            return;\n                        }\n                        panels.ieCachedRange = document.selection.createRange();\n                        panels.ieCachedScrollTop = panels.input.doc.scrollTop||0;\n                    };\n                }\n\n                if (!button.isHelp) {\n                    button.onclick = function () {\n                        if (this.onmouseout) {\n                            this.onmouseout();\n                        }\n                        doClick(this);\n                        return false;\n                    }\n                }\n            }\n            else {\n                image.style.backgroundPosition = button.XShift + \" \" + disabledYShift;\n                button.onmouseover = button.onmouseout = button.onclick = function () { };\n                button.className += \" disabled\";\n            }\n        }\n\n        function bindCommand(method) {\n            if (typeof method === \"string\")\n                method = commandManager[method];\n            return function () { method.apply(commandManager, arguments); }\n        }\n\n        function makeSpritedButtonRow() {\n\n            var buttonBar = panels.buttonBar;\n\n            var normalYShift = \"0px\";\n            var disabledYShift = \"-20px\";\n            var highlightYShift = \"-40px\";\n\n            var buttonRow = document.createElement(\"ul\");\n            buttonRow.id = \"wmd-button-row\" + postfix;\n            buttonRow.className = 'wmd-button-row';\n            buttonRow = buttonBar.appendChild(buttonRow);\n            var xPosition = 0;\n            var makeButton = function (id, title, XShift, textOp) {\n                var button = document.createElement(\"li\");\n                button.className = \"wmd-button\";\n                button.style.left = xPosition + \"px\";\n                xPosition += 25;\n                var buttonImage = document.createElement(\"span\");\n                button.id = id + postfix;\n                button.appendChild(buttonImage);\n                button.title = title;\n                button.XShift = XShift;\n                if (textOp)\n                    button.textOp = textOp;\n                setupButton(button, true);\n                buttonRow.appendChild(button);\n                return button;\n            };\n            var makeSpacer = function (num) {\n                var spacer = document.createElement(\"li\");\n                spacer.className = \"wmd-spacer wmd-spacer\" + num;\n                spacer.id = \"wmd-spacer\" + num + postfix;\n                buttonRow.appendChild(spacer);\n                xPosition += 25;\n            }\n\n            buttons.bold = makeButton(\"wmd-bold-button\", getStringAndKey(\"bold\"), \"0px\", bindCommand(\"doBold\"));\n            buttons.italic = makeButton(\"wmd-italic-button\", getStringAndKey(\"italic\"), \"-20px\", bindCommand(\"doItalic\"));\n            makeSpacer(1);\n            buttons.link = makeButton(\"wmd-link-button\", getStringAndKey(\"link\"), \"-40px\", bindCommand(function (chunk, postProcessing) {\n                return this.doLinkOrImage(chunk, postProcessing, false);\n            }));\n            buttons.quote = makeButton(\"wmd-quote-button\", getStringAndKey(\"quote\"), \"-60px\", bindCommand(\"doBlockquote\"));\n            buttons.code = makeButton(\"wmd-code-button\", getStringAndKey(\"code\"), \"-80px\", bindCommand(\"doCode\"));\n            buttons.image = makeButton(\"wmd-image-button\", getStringAndKey(\"image\"), \"-100px\", bindCommand(function (chunk, postProcessing) {\n                return this.doLinkOrImage(chunk, postProcessing, true);\n            }));\n            makeSpacer(2);\n            buttons.olist = makeButton(\"wmd-olist-button\", getStringAndKey(\"olist\"), \"-120px\", bindCommand(function (chunk, postProcessing) {\n                this.doList(chunk, postProcessing, true);\n            }));\n            buttons.ulist = makeButton(\"wmd-ulist-button\", getStringAndKey(\"ulist\"), \"-140px\", bindCommand(function (chunk, postProcessing) {\n                this.doList(chunk, postProcessing, false);\n            }));\n            buttons.heading = makeButton(\"wmd-heading-button\", getStringAndKey(\"heading\"), \"-160px\", bindCommand(\"doHeading\"));\n            buttons.hr = makeButton(\"wmd-hr-button\", getStringAndKey(\"hr\"), \"-180px\", bindCommand(\"doHorizontalRule\"));\n            buttons.table = makeButton(\"wmd-hr-table\", getStringAndKey(\"table\"), \"-180px\", bindCommand(\"doTable\"));\n            makeSpacer(3);\n            buttons.undo = makeButton(\"wmd-undo-button\", getStringAndKey(\"undo\"), \"-200px\", null);\n            buttons.undo.execute = function (manager) { inputBox.doc.undo(); };\n\n            buttons.redo = makeButton(\"wmd-redo-button\", getStringAndKey(\"redo\"), \"-220px\", null);\n            buttons.redo.execute = function (manager) { inputBox.doc.redo(); };\n\n            if (helpOptions) {\n                var helpButton = document.createElement(\"li\");\n                var helpButtonImage = document.createElement(\"span\");\n                helpButton.appendChild(helpButtonImage);\n                helpButton.className = \"wmd-button wmd-help-button\";\n                helpButton.id = \"wmd-help-button\" + postfix;\n                helpButton.XShift = \"-240px\";\n                helpButton.isHelp = true;\n                helpButton.style.right = \"0px\";\n                helpButton.title = getString(\"help\");\n                helpButton.onclick = helpOptions.handler;\n\n                setupButton(helpButton, true);\n                buttonRow.appendChild(helpButton);\n                buttons.help = helpButton;\n            }\n\n            that.setUndoRedoButtonStates();\n            inputBox.on('change', function() {\n                that.setUndoRedoButtonStates();\n            });\n        }\n\n        this.buttons = buttons;\n        this.setButtonState = setupButton;\n\n    }\n\n    function CommandManager(pluginHooks, getString) {\n        this.hooks = pluginHooks;\n        this.getString = getString;\n    }\n\n    var commandProto = CommandManager.prototype;\n\n    // The markdown symbols - 4 spaces = code, > = blockquote, etc.\n    commandProto.prefixes = \"(?:\\\\s{4,}|\\\\s*>|\\\\s*-\\\\s+|\\\\s*\\\\d+\\\\.|=|\\\\+|-|_|\\\\*|#|\\\\s*\\\\[[^\\n]]+\\\\]:)\";\n\n    // Remove markdown symbols from the chunk selection.\n    commandProto.unwrap = function (chunk) {\n        var txt = new re(\"([^\\\\n])\\\\n(?!(\\\\n|\" + this.prefixes + \"))\", \"g\");\n        chunk.selection = chunk.selection.replace(txt, \"$1 $2\");\n    };\n\n    commandProto.wrap = function (chunk, len) {\n        this.unwrap(chunk);\n        var regex = new re(\"(.{1,\" + len + \"})( +|$\\\\n?)\", \"gm\"),\n            that = this;\n\n        chunk.selection = chunk.selection.replace(regex, function (line, marked) {\n            if (new re(\"^\" + that.prefixes, \"\").test(line)) {\n                return line;\n            }\n            return marked + \"\\n\";\n        });\n\n        chunk.selection = chunk.selection.replace(/\\s+$/, \"\");\n    };\n\n    commandProto.doBold = function (chunk, postProcessing) {\n        return this.doBorI(chunk, postProcessing, 2, this.getString(\"boldexample\"));\n    };\n\n    commandProto.doItalic = function (chunk, postProcessing) {\n        return this.doBorI(chunk, postProcessing, 1, this.getString(\"italicexample\"));\n    };\n\n    // chunk: The selected region that will be enclosed with */**\n    // nStars: 1 for italics, 2 for bold\n    // insertText: If you just click the button without highlighting text, this gets inserted\n    commandProto.doBorI = function (chunk, postProcessing, nStars, insertText) {\n\n        // Get rid of whitespace and fixup newlines.\n        chunk.trimWhitespace();\n        chunk.selection = chunk.selection.replace(/\\n{2,}/g, \"\\n\");\n\n        // Look for stars before and after.  Is the chunk already marked up?\n        // note that these regex matches cannot fail\n        var starsBefore = /(\\**$)/.exec(chunk.before)[0];\n        var starsAfter = /(^\\**)/.exec(chunk.after)[0];\n\n        var prevStars = Math.min(starsBefore.length, starsAfter.length);\n\n        // Remove stars if we have to since the button acts as a toggle.\n        if ((prevStars >= nStars) && (prevStars != 2 || nStars != 1)) {\n            chunk.before = chunk.before.replace(re(\"[*]{\" + nStars + \"}$\", \"\"), \"\");\n            chunk.after = chunk.after.replace(re(\"^[*]{\" + nStars + \"}\", \"\"), \"\");\n        }\n        else if (!chunk.selection && starsAfter) {\n            // It's not really clear why this code is necessary.  It just moves\n            // some arbitrary stuff around.\n            chunk.after = chunk.after.replace(/^([*_]*)/, \"\");\n            chunk.before = chunk.before.replace(/(\\s?)$/, \"\");\n            var whitespace = re.$1;\n            chunk.before = chunk.before + starsAfter + whitespace;\n        }\n        else {\n\n            // In most cases, if you don't have any selected text and click the button\n            // you'll get a selected, marked up region with the default text inserted.\n            if (!chunk.selection && !starsAfter) {\n                chunk.selection = insertText;\n            }\n\n            // Add the true markup.\n            var markup = nStars <= 1 ? \"*\" : \"**\"; // shouldn't the test be = ?\n            chunk.before = chunk.before + markup;\n            chunk.after = markup + chunk.after;\n        }\n\n        return;\n    };\n\n    commandProto.stripLinkDefs = function (text, defsToAdd) {\n\n        text = text.replace(/^[ ]{0,3}\\[(\\d+)\\]:[ \\t]*\\n?[ \\t]*<?(\\S+?)>?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"(](.+?)[\")][ \\t]*)?(?:\\n+|$)/gm,\n            function (totalMatch, id, link, newlines, title) {\n                defsToAdd[id] = totalMatch.replace(/\\s*$/, \"\");\n                if (newlines) {\n                    // Strip the title and return that separately.\n                    defsToAdd[id] = totalMatch.replace(/[\"(](.+?)[\")]$/, \"\");\n                    return newlines + title;\n                }\n                return \"\";\n            });\n\n        return text;\n    };\n\n    commandProto.addLinkDef = function (chunk, linkDef) {\n\n        var refNumber = 0; // The current reference number\n        var defsToAdd = {}; //\n        // Start with a clean slate by removing all previous link definitions.\n        chunk.before = this.stripLinkDefs(chunk.before, defsToAdd);\n        chunk.selection = this.stripLinkDefs(chunk.selection, defsToAdd);\n        chunk.after = this.stripLinkDefs(chunk.after, defsToAdd);\n\n        var defs = \"\";\n        var regex = /(\\[)((?:\\[[^\\]]*\\]|[^\\[\\]])*)(\\][ ]?(?:\\n[ ]*)?\\[)(\\d+)(\\])/g;\n\n        var addDefNumber = function (def) {\n            refNumber++;\n            def = def.replace(/^[ ]{0,3}\\[(\\d+)\\]:/, \"  [\" + refNumber + \"]:\");\n            defs += \"\\n\" + def;\n        };\n\n        // note that\n        // a) the recursive call to getLink cannot go infinite, because by definition\n        //    of regex, inner is always a proper substring of wholeMatch, and\n        // b) more than one level of nesting is neither supported by the regex\n        //    nor making a lot of sense (the only use case for nesting is a linked image)\n        var getLink = function (wholeMatch, before, inner, afterInner, id, end) {\n            inner = inner.replace(regex, getLink);\n            if (defsToAdd[id]) {\n                addDefNumber(defsToAdd[id]);\n                return before + inner + afterInner + refNumber + end;\n            }\n            return wholeMatch;\n        };\n\n        chunk.before = chunk.before.replace(regex, getLink);\n\n        if (linkDef) {\n            addDefNumber(linkDef);\n        }\n        else {\n            chunk.selection = chunk.selection.replace(regex, getLink);\n        }\n\n        var refOut = refNumber;\n\n        chunk.after = chunk.after.replace(regex, getLink);\n\n        if (chunk.after) {\n            chunk.after = chunk.after.replace(/\\n*$/, \"\");\n        }\n        if (!chunk.after) {\n            chunk.selection = chunk.selection.replace(/\\n*$/, \"\");\n        }\n\n        chunk.after += \"\\n\\n\" + defs;\n\n        return refOut;\n    };\n\n    // takes the line as entered into the add link/as image dialog and makes\n    // sure the URL and the optinal title are \"nice\".\n    function properlyEncoded(linkdef) {\n        return linkdef.replace(/^\\s*(.*?)(?:\\s+\"(.+)\")?\\s*$/, function (wholematch, link, title) {\n            link = link.replace(/\\?.*$/, function (querypart) {\n                return querypart.replace(/\\+/g, \" \"); // in the query string, a plus and a space are identical\n            });\n            link = decodeURIComponent(link); // unencode first, to prevent double encoding\n            link = encodeURI(link).replace(/'/g, '%27').replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n            link = link.replace(/\\?.*$/, function (querypart) {\n                return querypart.replace(/\\+/g, \"%2b\"); // since we replaced plus with spaces in the query part, all pluses that now appear where originally encoded\n            });\n            if (title) {\n                title = title.trim ? title.trim() : title.replace(/^\\s*/, \"\").replace(/\\s*$/, \"\");\n                title = title.replace(/\"/g, \"quot;\").replace(/\\(/g, \"&#40;\").replace(/\\)/g, \"&#41;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n            }\n            return title ? link + ' \"' + title + '\"' : link;\n        });\n    }\n\n    commandProto.doLinkOrImage = function (chunk, postProcessing, isImage) {\n\n        chunk.trimWhitespace();\n        chunk.findTags(/\\s*!?\\[/, /\\][ ]?(?:\\n[ ]*)?(\\[.*?\\])?/);\n        var background;\n\n        if (chunk.endTag.length > 1 && chunk.startTag.length > 0) {\n\n            chunk.startTag = chunk.startTag.replace(/!?\\[/, \"\");\n            chunk.endTag = \"\";\n            this.addLinkDef(chunk, null);\n\n        }\n        else {\n            \n            // We're moving start and end tag back into the selection, since (as we're in the else block) we're not\n            // *removing* a link, but *adding* one, so whatever findTags() found is now back to being part of the\n            // link text. linkEnteredCallback takes care of escaping any brackets.\n            chunk.selection = chunk.startTag + chunk.selection + chunk.endTag;\n            chunk.startTag = chunk.endTag = \"\";\n\n            if (/\\n\\n/.test(chunk.selection)) {\n                this.addLinkDef(chunk, null);\n                return;\n            }\n            var that = this;\n            // The function to be executed when you enter a link and press OK or Cancel.\n            // Marks up the link and adds the ref.\n            var linkEnteredCallback = function (link) {\n\n                background.parentNode.removeChild(background);\n\n                if (link !== null) {\n                    // (                          $1\n                    //     [^\\\\]                  anything that's not a backslash\n                    //     (?:\\\\\\\\)*              an even number (this includes zero) of backslashes\n                    // )\n                    // (?=                        followed by\n                    //     [[\\]]                  an opening or closing bracket\n                    // )\n                    //\n                    // In other words, a non-escaped bracket. These have to be escaped now to make sure they\n                    // don't count as the end of the link or similar.\n                    // Note that the actual bracket has to be a lookahead, because (in case of to subsequent brackets),\n                    // the bracket in one match may be the \"not a backslash\" character in the next match, so it\n                    // should not be consumed by the first match.\n                    // The \"prepend a space and finally remove it\" steps makes sure there is a \"not a backslash\" at the\n                    // start of the string, so this also works if the selection begins with a bracket. We cannot solve\n                    // this by anchoring with ^, because in the case that the selection starts with two brackets, this\n                    // would mean a zero-width match at the start. Since zero-width matches advance the string position,\n                    // the first bracket could then not act as the \"not a backslash\" for the second.\n                    chunk.selection = (\" \" + chunk.selection).replace(/([^\\\\](?:\\\\\\\\)*)(?=[[\\]])/g, \"$1\\\\\").substr(1);\n                    \n                    var linkDef = \" [999]: \" + properlyEncoded(link);\n\n                    var num = that.addLinkDef(chunk, linkDef);\n                    chunk.startTag = isImage ? \"![\" : \"[\";\n                    chunk.endTag = \"][\" + num + \"]\";\n\n                    if (!chunk.selection) {\n                        if (isImage) {\n                            chunk.selection = that.getString(\"imagedescription\");\n                        }\n                        else {\n                            chunk.selection = that.getString(\"linkdescription\");\n                        }\n                    }\n                }\n                postProcessing();\n            };\n\n            background = ui.createBackground();\n\n            if (isImage) {\n                if (!this.hooks.insertImageDialog(linkEnteredCallback))\n                    ui.prompt(this.getString(\"imagedialog\"), imageDefaultText, linkEnteredCallback);\n            }\n            else {\n                if (!this.hooks.insertLinkDialog(linkEnteredCallback))\n                    ui.prompt(this.getString(\"linkdialog\"), linkDefaultText, linkEnteredCallback);\n            }\n            return true;\n        }\n    };\n\n    // When making a list, hitting shift-enter will put your cursor on the next line\n    // at the current indent level.\n    commandProto.doAutoindent = function (chunk, postProcessing) {\n\n        var commandMgr = this,\n            fakeSelection = false;\n\n        chunk.before = chunk.before.replace(/(\\n|^)[ ]{0,3}([*+-]|\\d+[.])[ \\t]*\\n$/, \"\\n\\n\");\n        chunk.before = chunk.before.replace(/(\\n|^)[ ]{0,3}>[ \\t]*\\n$/, \"\\n\\n\");\n        chunk.before = chunk.before.replace(/(\\n|^)[ \\t]+\\n$/, \"\\n\\n\");\n        \n        // There's no selection, end the cursor wasn't at the end of the line:\n        // The user wants to split the current list item / code line / blockquote line\n        // (for the latter it doesn't really matter) in two. Temporarily select the\n        // (rest of the) line to achieve this.\n        if (!chunk.selection && !/^[ \\t]*(?:\\n|$)/.test(chunk.after)) {\n            chunk.after = chunk.after.replace(/^[^\\n]*/, function (wholeMatch) {\n                chunk.selection = wholeMatch;\n                return \"\";\n            });\n            fakeSelection = true;\n        }\n\n        if (/(\\n|^)[ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*\\n$/.test(chunk.before)) {\n            if (commandMgr.doList) {\n                commandMgr.doList(chunk);\n            }\n        }\n        if (/(\\n|^)[ ]{0,3}>[ \\t]+.*\\n$/.test(chunk.before)) {\n            if (commandMgr.doBlockquote) {\n                commandMgr.doBlockquote(chunk);\n            }\n        }\n        if (/(\\n|^)(\\t|[ ]{4,}).*\\n$/.test(chunk.before)) {\n            if (commandMgr.doCode) {\n                commandMgr.doCode(chunk);\n            }\n        }\n        \n        if (fakeSelection) {\n            chunk.after = chunk.selection + chunk.after;\n            chunk.selection = \"\";\n        }\n    };\n\n    commandProto.doBlockquote = function (chunk, postProcessing) {\n\n        chunk.selection = chunk.selection.replace(/^(\\n*)([^\\r]+?)(\\n*)$/,\n            function (totalMatch, newlinesBefore, text, newlinesAfter) {\n                chunk.before += newlinesBefore;\n                chunk.after = newlinesAfter + chunk.after;\n                return text;\n            });\n\n        chunk.before = chunk.before.replace(/(>[ \\t]*)$/,\n            function (totalMatch, blankLine) {\n                chunk.selection = blankLine + chunk.selection;\n                return \"\";\n            });\n\n        chunk.selection = chunk.selection.replace(/^(\\s|>)+$/, \"\");\n        chunk.selection = chunk.selection || this.getString(\"quoteexample\");\n\n        // The original code uses a regular expression to find out how much of the\n        // text *directly before* the selection already was a blockquote:\n\n        /*\n        if (chunk.before) {\n        chunk.before = chunk.before.replace(/\\n?$/, \"\\n\");\n        }\n        chunk.before = chunk.before.replace(/(((\\n|^)(\\n[ \\t]*)*>(.+\\n)*.*)+(\\n[ \\t]*)*$)/,\n        function (totalMatch) {\n        chunk.startTag = totalMatch;\n        return \"\";\n        });\n        */\n\n        // This comes down to:\n        // Go backwards as many lines a possible, such that each line\n        //  a) starts with \">\", or\n        //  b) is almost empty, except for whitespace, or\n        //  c) is preceeded by an unbroken chain of non-empty lines\n        //     leading up to a line that starts with \">\" and at least one more character\n        // and in addition\n        //  d) at least one line fulfills a)\n        //\n        // Since this is essentially a backwards-moving regex, it's susceptible to\n        // catstrophic backtracking and can cause the browser to hang;\n        // see e.g. http://meta.stackoverflow.com/questions/9807.\n        //\n        // Hence we replaced this by a simple state machine that just goes through the\n        // lines and checks for a), b), and c).\n\n        var match = \"\",\n            leftOver = \"\",\n            line;\n        if (chunk.before) {\n            var lines = chunk.before.replace(/\\n$/, \"\").split(\"\\n\");\n            var inChain = false;\n            for (var i = 0; i < lines.length; i++) {\n                var good = false;\n                line = lines[i];\n                inChain = inChain && line.length > 0; // c) any non-empty line continues the chain\n                if (/^>/.test(line)) {                // a)\n                    good = true;\n                    if (!inChain && line.length > 1)  // c) any line that starts with \">\" and has at least one more character starts the chain\n                        inChain = true;\n                } else if (/^[ \\t]*$/.test(line)) {   // b)\n                    good = true;\n                } else {\n                    good = inChain;                   // c) the line is not empty and does not start with \">\", so it matches if and only if we're in the chain\n                }\n                if (good) {\n                    match += line + \"\\n\";\n                } else {\n                    leftOver += match + line;\n                    match = \"\\n\";\n                }\n            }\n            if (!/(^|\\n)>/.test(match)) {             // d)\n                leftOver += match;\n                match = \"\";\n            }\n        }\n\n        chunk.startTag = match;\n        chunk.before = leftOver;\n\n        // end of change\n\n        /*benweet Don't really know the purpose of it but it is destructive\n        \n        if (chunk.after) {\n            chunk.after = chunk.after.replace(/^\\n?/, \"\\n\");\n        }\n\n        chunk.after = chunk.after.replace(/^(((\\n|^)(\\n[ \\t]*)*>(.+\\n)*.*)+(\\n[ \\t]*)*)/,\n            function (totalMatch) {\n                chunk.endTag = totalMatch;\n                return \"\";\n            }\n        );\n        */\n\n        var replaceBlanksInTags = function (useBracket) {\n\n            var replacement = useBracket ? \"> \" : \"\";\n\n            if (chunk.startTag) {\n                chunk.startTag = chunk.startTag.replace(/\\n((>|\\s)*)\\n$/,\n                    function (totalMatch, markdown) {\n                        return \"\\n\" + markdown.replace(/^[ ]{0,3}>?[ \\t]*$/gm, replacement) + \"\\n\";\n                    });\n            }\n            if (chunk.endTag) {\n                chunk.endTag = chunk.endTag.replace(/^\\n((>|\\s)*)\\n/,\n                    function (totalMatch, markdown) {\n                        return \"\\n\" + markdown.replace(/^[ ]{0,3}>?[ \\t]*$/gm, replacement) + \"\\n\";\n                    });\n            }\n        };\n\n        if (/^(?![ ]{0,3}>)/m.test(chunk.selection)) {\n            this.wrap(chunk, SETTINGS.lineLength - 2);\n            chunk.selection = chunk.selection.replace(/^/gm, \"> \");\n            replaceBlanksInTags(true);\n            chunk.skipLines();\n        } else {\n            chunk.selection = chunk.selection.replace(/^[ ]{0,3}> ?/gm, \"\");\n            this.unwrap(chunk);\n            replaceBlanksInTags(false);\n\n            if (!/^(\\n|^)[ ]{0,3}>/.test(chunk.selection) && chunk.startTag) {\n                chunk.startTag = chunk.startTag.replace(/\\n{0,2}$/, \"\\n\\n\");\n            }\n\n            if (!/(\\n|^)[ ]{0,3}>.*$/.test(chunk.selection) && chunk.endTag) {\n                chunk.endTag = chunk.endTag.replace(/^\\n{0,2}/, \"\\n\\n\");\n            }\n        }\n\n        chunk.selection = this.hooks.postBlockquoteCreation(chunk.selection);\n\n        if (!/\\n/.test(chunk.selection)) {\n            chunk.selection = chunk.selection.replace(/^(> *)/,\n            function (wholeMatch, blanks) {\n                chunk.startTag += blanks;\n                return \"\";\n            });\n        }\n    };\n\n    commandProto.doCode = function (chunk, postProcessing) {\n\n        var hasTextBefore = /\\S[ ]*$/.test(chunk.before);\n        var hasTextAfter = /^[ ]*\\S/.test(chunk.after);\n\n        // Use 'four space' markdown if the selection is on its own\n        // line or is multiline.\n        if ((!hasTextAfter && !hasTextBefore) || /\\n/.test(chunk.selection)) {\n\n            chunk.before = chunk.before.replace(/[ ]{4}$/,\n                function (totalMatch) {\n                    chunk.selection = totalMatch + chunk.selection;\n                    return \"\";\n                });\n\n            var nLinesBack = 1;\n            var nLinesForward = 1;\n\n            if (/(\\n|^)(\\t|[ ]{4,}).*\\n$/.test(chunk.before)) {\n                nLinesBack = 0;\n            }\n            if (/^\\n(\\t|[ ]{4,})/.test(chunk.after)) {\n                nLinesForward = 0;\n            }\n\n            chunk.skipLines(nLinesBack, nLinesForward);\n\n            if (!chunk.selection) {\n                chunk.startTag = \"    \";\n                chunk.selection = this.getString(\"codeexample\");\n            }\n            else {\n                if (/^[ ]{0,3}\\S/m.test(chunk.selection)) {\n                    if (/\\n/.test(chunk.selection))\n                        chunk.selection = chunk.selection.replace(/^/gm, \"    \");\n                    else // if it's not multiline, do not select the four added spaces; this is more consistent with the doList behavior\n                        chunk.before += \"    \";\n                }\n                else {\n                    chunk.selection = chunk.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\\t)/gm, \"\");\n                }\n            }\n        }\n        else {\n            // Use backticks (`) to delimit the code block.\n\n            chunk.trimWhitespace();\n            chunk.findTags(/`/, /`/);\n\n            if (!chunk.startTag && !chunk.endTag) {\n                chunk.startTag = chunk.endTag = \"`\";\n                if (!chunk.selection) {\n                    chunk.selection = this.getString(\"codeexample\");\n                }\n            }\n            else if (chunk.endTag && !chunk.startTag) {\n                chunk.before += chunk.endTag;\n                chunk.endTag = \"\";\n            }\n            else {\n                chunk.startTag = chunk.endTag = \"\";\n            }\n        }\n    };\n\n    commandProto.doList = function (chunk, postProcessing, isNumberedList) {\n\n        // These are identical except at the very beginning and end.\n        // Should probably use the regex extension function to make this clearer.\n        var previousItemsRegex = /(\\n|^)(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*)(\\n.+|\\n{2,}([*+-].*|\\d+[.])[ \\t]+.*|\\n{2,}[ \\t]+\\S.*)*)\\n*$/;\n        var nextItemsRegex = /^\\n*(([ ]{0,3}([*+-]|\\d+[.])[ \\t]+.*)(\\n.+|\\n{2,}([*+-].*|\\d+[.])[ \\t]+.*|\\n{2,}[ \\t]+\\S.*)*)\\n*/;\n\n        // The default bullet is a dash but others are possible.\n        // This has nothing to do with the particular HTML bullet,\n        // it's just a markdown bullet.\n        var bullet = \"-\";\n\n        // The number in a numbered list.\n        var num = 1;\n\n        // Get the item prefix - e.g. \" 1. \" for a numbered list, \" - \" for a bulleted list.\n        var getItemPrefix = function () {\n            var prefix;\n            if (isNumberedList) {\n                prefix = \" \" + num + \". \";\n                num++;\n            }\n            else {\n                prefix = \" \" + bullet + \" \";\n            }\n            return prefix;\n        };\n\n        // Fixes the prefixes of the other list items.\n        var getPrefixedItem = function (itemText) {\n\n            // The numbering flag is unset when called by autoindent.\n            if (isNumberedList === undefined) {\n                isNumberedList = /^\\s*\\d/.test(itemText);\n            }\n\n            // Renumber/bullet the list element.\n            itemText = itemText.replace(/^[ ]{0,3}([*+-]|\\d+[.])\\s/gm,\n                function (_) {\n                    return getItemPrefix();\n                });\n\n            return itemText;\n        };\n\n        chunk.findTags(/(\\n|^)*[ ]{0,3}([*+-]|\\d+[.])\\s+/, null);\n\n        if (chunk.before && !/\\n$/.test(chunk.before) && !/^\\n/.test(chunk.startTag)) {\n            chunk.before += chunk.startTag;\n            chunk.startTag = \"\";\n        }\n\n        if (chunk.startTag) {\n\n            var hasDigits = /\\d+[.]/.test(chunk.startTag);\n            chunk.startTag = \"\";\n            chunk.selection = chunk.selection.replace(/\\n[ ]{4}/g, \"\\n\");\n            this.unwrap(chunk);\n            chunk.skipLines();\n\n            if (hasDigits) {\n                // Have to renumber the bullet points if this is a numbered list.\n                chunk.after = chunk.after.replace(nextItemsRegex, getPrefixedItem);\n            }\n            if (isNumberedList == hasDigits) {\n                return;\n            }\n        }\n\n        var nLinesUp = 1;\n\n        chunk.before = chunk.before.replace(previousItemsRegex,\n            function (itemText) {\n                if (/^\\s*([*+-])/.test(itemText)) {\n                    bullet = re.$1;\n                }\n                nLinesUp = /[^\\n]\\n\\n[^\\n]/.test(itemText) ? 1 : 0;\n                return getPrefixedItem(itemText);\n            });\n\n        if (!chunk.selection) {\n            chunk.selection = this.getString(\"litem\");\n        }\n\n        var prefix = getItemPrefix();\n\n        var nLinesDown = 1;\n\n        chunk.after = chunk.after.replace(nextItemsRegex,\n            function (itemText) {\n                nLinesDown = /[^\\n]\\n\\n[^\\n]/.test(itemText) ? 1 : 0;\n                return getPrefixedItem(itemText);\n            });\n\n        chunk.trimWhitespace(true);\n        chunk.skipLines(nLinesUp, nLinesDown, true);\n        chunk.startTag = prefix;\n        var spaces = prefix.replace(/./g, \" \");\n        this.wrap(chunk, SETTINGS.lineLength - spaces.length);\n        chunk.selection = chunk.selection.replace(/\\n/g, \"\\n\" + spaces);\n\n    };\n\n    commandProto.doHeading = function (chunk, postProcessing) {\n\n        // Remove leading/trailing whitespace and reduce internal spaces to single spaces.\n        chunk.selection = chunk.selection.replace(/\\s+/g, \" \");\n        chunk.selection = chunk.selection.replace(/(^\\s+|\\s+$)/g, \"\");\n\n        // If we clicked the button with no selected text, we just\n        // make a level 2 hash header around some default text.\n        if (!chunk.selection) {\n            chunk.startTag = \"## \";\n            chunk.selection = this.getString(\"headingexample\");\n            chunk.endTag = \" ##\";\n            return;\n        }\n\n        var headerLevel = 0;     // The existing header level of the selected text.\n\n        // Remove any existing hash heading markdown and save the header level.\n        chunk.findTags(/#+[ ]*/, /[ ]*#+/);\n        if (/#+/.test(chunk.startTag)) {\n            headerLevel = re.lastMatch.length;\n        }\n        chunk.startTag = chunk.endTag = \"\";\n\n        // Try to get the current header level by looking for - and = in the line\n        // below the selection.\n        chunk.findTags(null, /\\s?(-+|=+)/);\n        if (/=+/.test(chunk.endTag)) {\n            headerLevel = 1;\n        }\n        if (/-+/.test(chunk.endTag)) {\n            headerLevel = 2;\n        }\n\n        // Skip to the next line so we can create the header markdown.\n        chunk.startTag = chunk.endTag = \"\";\n        chunk.skipLines(1, 1);\n\n        // We make a level 2 header if there is no current header.\n        // If there is a header level, we substract one from the header level.\n        // If it's already a level 1 header, it's removed.\n        var headerLevelToCreate = headerLevel == 0 ? 2 : headerLevel - 1;\n\n        if (headerLevelToCreate > 0) {\n\n            // The button only creates level 1 and 2 underline headers.\n            // Why not have it iterate over hash header levels?  Wouldn't that be easier and cleaner?\n            var headerChar = headerLevelToCreate >= 2 ? \"-\" : \"=\";\n            var len = chunk.selection.length;\n            if (len > SETTINGS.lineLength) {\n                len = SETTINGS.lineLength;\n            }\n            chunk.endTag = \"\\n\";\n            while (len--) {\n                chunk.endTag += headerChar;\n            }\n        }\n    };\n\n    commandProto.doHorizontalRule = function (chunk, postProcessing) {\n        chunk.startTag = \"----------\\n\";\n        chunk.selection = \"\";\n        chunk.skipLines(2, 1, true);\n    }\n\n    commandProto.doTable = function (chunk, postProcessing) {\n        chunk.startTag = `|  |  |  |\n|--|--|--|\n|  |  |  |`;\n        chunk.selection = \"\";\n    }\n\n})();\n\nexport default Markdown\n","import CodeMirror from 'codemirror'\nimport 'codemirror/mode/markdown/markdown'\nimport 'codemirror/addon/mode/overlay'\n\nvar urlRE = /^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\\.beep|\\.lwz|\\.xpc|\\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\\.beeps?|xmpp|xri|ymsgr|z39\\.50[rs]?):(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]|\\([^\\s()<>]*\\))+(?:\\([^\\s()<>]*\\)|[^\\s`*!()\\[\\]{};:'\".,<>?«»“”‘’]))/i\n\nCodeMirror.defineMode(\n\t'gfm',\n\tfunction(config, modeConfig) {\n\t\tvar codeDepth = 0\n\t\tfunction blankLine(state) {\n\t\t\tstate.code = false\n\t\t\treturn null\n\t\t}\n\t\tvar gfmOverlay = {\n\t\t\tstartState: function() {\n\t\t\t\treturn {\n\t\t\t\t\tcode: false,\n\t\t\t\t\tcodeBlock: false,\n\t\t\t\t\tateSpace: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tcopyState: function(s) {\n\t\t\t\treturn {\n\t\t\t\t\tcode: s.code,\n\t\t\t\t\tcodeBlock: s.codeBlock,\n\t\t\t\t\tateSpace: s.ateSpace,\n\t\t\t\t}\n\t\t\t},\n\t\t\ttoken: function(stream, state) {\n\t\t\t\tstate.combineTokens = null\n\n\t\t\t\t// Hack to prevent formatting override inside code blocks (block and inline)\n\t\t\t\tif (state.codeBlock) {\n\t\t\t\t\tif (stream.match(/^````+/) || stream.match(/^\\|.*/)) {\n\t\t\t\t\t\tstate.codeBlock = false\n\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\tstream.skipToEnd()\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tif (stream.sol()) {\n\t\t\t\t\tstate.code = false\n\t\t\t\t}\n                if (stream.sol() && (stream.match(/^````+/) || stream.match(/^\\|.*/))) {\n\t\t\t\t\tstream.skipToEnd()\n\t\t\t\t\tstate.codeBlock = true\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\t// If this block is changed, it may need to be updated in Markdown mode\n\t\t\t\tif (stream.peek() === '`') {\n\t\t\t\t\tstream.next()\n\t\t\t\t\tvar before = stream.pos\n\t\t\t\t\tstream.eatWhile('`')\n\t\t\t\t\tvar difference = 1 + stream.pos - before\n\t\t\t\t\tif (!state.code) {\n\t\t\t\t\t\tcodeDepth = difference\n\t\t\t\t\t\tstate.code = true\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (difference === codeDepth) {\n\t\t\t\t\t\t\t// Must be exact\n\t\t\t\t\t\t\tstate.code = false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null\n\t\t\t\t} else if (state.code) {\n\t\t\t\t\tstream.next()\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\t// Check if space. If so, links can be formatted later on\n\t\t\t\tif (stream.eatSpace()) {\n\t\t\t\t\tstate.ateSpace = true\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tif (stream.sol() || state.ateSpace) {\n\t\t\t\t\tstate.ateSpace = false\n\t\t\t\t\tif (modeConfig.gitHubSpice !== false) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+@)?(?=.{0,6}\\d)(?:[a-f0-9]{7,40}\\b)/)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// User/Project@SHA\n\t\t\t\t\t\t\t// User@SHA\n\t\t\t\t\t\t\t// SHA\n\t\t\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\t\t\treturn 'link'\n\t\t\t\t\t\t} else if (stream.match(/^(?:[a-zA-Z0-9\\-_]+\\/)?(?:[a-zA-Z0-9\\-_]+)?#[0-9]+\\b/)) {\n\t\t\t\t\t\t\t// User/Project#Num\n\t\t\t\t\t\t\t// User#Num\n\t\t\t\t\t\t\t// #Num\n\t\t\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\t\t\treturn 'link'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tstream.match(urlRE) &&\n\t\t\t\t\tstream.string.slice(stream.start - 2, stream.start) != '](' &&\n\t\t\t\t\t(stream.start == 0 || /\\W/.test(stream.string.charAt(stream.start - 1)))\n\t\t\t\t) {\n\t\t\t\t\t// URLs\n\t\t\t\t\t// Taken from http://daringfireball.net/2010/07/improved_regex_for_matching_urls\n\t\t\t\t\t// And then (issue #1160) simplified to make it not crash the Chrome Regexp engine\n\t\t\t\t\t// And then limited url schemes to the CommonMark list, so foo:bar isn't matched as a URL\n\t\t\t\t\tstate.combineTokens = true\n\t\t\t\t\treturn 'link'\n\t\t\t\t}\n\t\t\t\tstream.next()\n\t\t\t\treturn null\n\t\t\t},\n\t\t\tblankLine: blankLine,\n\t\t}\n\n\t\tvar markdownConfig = {\n\t\t\ttaskLists: true,\n\t\t\tstrikethrough: true,\n\t\t\temoji: true,\n\t\t}\n\t\tfor (var attr in modeConfig) {\n\t\t\tmarkdownConfig[attr] = modeConfig[attr]\n\t\t}\n\t\tmarkdownConfig.name = 'markdown'\n\t\treturn CodeMirror.overlayMode(CodeMirror.getMode(config, markdownConfig), gfmOverlay)\n\t},\n\t'markdown'\n)\n\nCodeMirror.defineMIME('text/x-gfm', 'gfm')\n","import React, { Component, createRef } from 'react'\nimport { connect } from 'react-redux'\nimport styled from 'styled-components'\nimport ShareDB from 'sharedb/lib/client'\nimport io from 'socket.io-client'\n\nimport { setCmInstance } from '../../actions/editor'\n\nimport { default as PagedownConverter } from '../../vendor/Markdown.Converter'\nimport { default as PagedownEditor } from '../../vendor/Markdown.Editor'\n\nimport CodeMirror from 'codemirror'\n//import 'codemirror/mode/gfm/gfm'\nimport '../../vendor/modifiedGfm'\nimport 'codemirror/mode/javascript/javascript'\nimport 'codemirror/mode/css/css'\nimport 'codemirror/mode/clike/clike'\nimport '../../static/css/CodeMirrorStyle.css'\n\nconst FakeButtonsElement = styled.div`\n\tdisplay: none;\n`\n\nclass Editor extends Component {\n\teditorRef = createRef()\n\n\tcomponentDidMount() {\n\t\tconst pagedownConverter = new PagedownConverter.Converter()\n\t\tconst pagedownEditor = new PagedownEditor.Editor(pagedownConverter)\n\t\tconst codeMirror = CodeMirror.fromTextArea(this.editorRef.current, {\n\t\t\tvalue: '',\n\t\t\tmode: {\n\t\t\t\tname: 'markdown',\n\t\t\t\tallowAtxHeaderWithoutSpace: true,\n\t\t\t\thighlightFormatting: true,\n\t\t\t\tmaxBlockquoteDepth: 3,\n\t\t\t\tfencedCodeBlockHighlighting: true,\n\t\t\t},\n\t\t\tlineWrapping: true,\n\t\t})\n\t\tpagedownEditor.run(codeMirror)\n\t\tconst doClick = name =>\n\t\t\tpagedownEditor.uiManager.buttons[name] && pagedownEditor.uiManager.buttons[name].onclick()\n\t\tthis.props.setCmInstance({ codeMirror, doClick })\n\n\t\tlet stopWatch = false\n\n\t\tconst sharews = new WebSocket(`ws://localhost:4000`)\n\t\tconst shareconn = new ShareDB.Connection(sharews)\n\n\t\tconst sharedoc = shareconn.get('docs', 'Welcome')\n\t\tif (sharedoc.data == null) sharedoc.create(\"\", 'text');\n\t\tconsole.log(\"good123\")\n\n\t\tcodeMirror.on('change', (ed, chg) => {\n\t\t\tif (stopWatch) return\n\n\t\t\tconst stindex = ed.indexFromPos(chg.from)\n\t\t\tconst delta = chg.removed.join('\\n').length\n\t\t\tconst addedText = chg.text.join('\\n')\n\n\t\t\tif (delta) sharedoc.submitOp([stindex, { d: delta }])\n\t\t\tif (addedText) sharedoc.submitOp([stindex, addedText])\n\t\t})\n\n\t\tcodeMirror.on('cursorActivity', e => {\n\t\t\tconst stPos = codeMirror.getCursor('start')\n\t\t\tconst edPos = codeMirror.getCursor('end')\n\t\t\tconst hdPos = codeMirror.getCursor('head')\n\n\t\t\tconst stindex = codeMirror.indexFromPos(stPos)\n\t\t\tconst edindex = codeMirror.indexFromPos(edPos)\n\t\t\tconst hdindex = codeMirror.indexFromPos(hdPos)\n\t\t\tconst prefixed = hdindex === stindex && stindex !== edindex\n\n\t\t\tsocket.emit('anchor-update', { stindex, edindex, prefixed })\n\t\t})\n\n\t\tsharedoc.subscribe(d => {\n\t\t\tstopWatch = true\n\t\t\tcodeMirror.setValue(sharedoc.data || '')\n\t\t\tcodeMirror.setCursor(0, 0)\n\t\t\tcodeMirror.focus()\n\t\t\tstopWatch = false\n\t\t})\n\n\t\tsharedoc.on('op', (op, mine) => {\n\t\t\tif (mine) return\n\t\t\tconst index = op.length == 2 ? op[0] : 0\n\t\t\tconst data = op.length === 2 ? op[1] : op[0]\n\n\t\t\tif (typeof data === 'string') {\n\t\t\t\tconst pos = codeMirror.posFromIndex(index)\n\n\t\t\t\tstopWatch = true\n\t\t\t\tcodeMirror.replaceRange(data, pos, pos)\n\t\t\t\tstopWatch = false\n\t\t\t} else {\n\t\t\t\tconst delCt = data.d\n\t\t\t\tconst stPos = codeMirror.posFromIndex(index)\n\t\t\t\tconst edPos = codeMirror.posFromIndex(index + delCt)\n\t\t\t\tconst range = { start: stPos, end: edPos }\n\n\t\t\t\tstopWatch = true\n\t\t\t\tcodeMirror.replaceRange('', stPos, edPos)\n\t\t\t\tstopWatch = false\n\t\t\t}\n\t\t})\n\n\t\tconst addName = (id, name) => {\n\t\t\tconst userslist = document.querySelector('#users')\n\t\t\tconst usericon = document.createElement('li')\n\t\t\tusericon.classList.add(`u-${id}`)\n\t\t\tusericon.innerHTML = name\n\t\t\tuserslist.appendChild(usericon)\n\n\t\t\tconst color = idToColor(id)\n\t\t\tconst styleTag = document.createElement('style')\n\t\t\tstyleTag.id = `style-${id}`\n\t\t\tstyleTag.innerHTML = `\n                .u-${id} { background-color: ${color}; }\n                .CodeMirror-line .u-${id}                   { background-color: ${hexToRgbaStyle(color, 0.35)}; }\n                .CodeMirror-line .u-${id}.cursor            { opacity: 1; }\n                .CodeMirror-line .u-${id}.cursor.left       { border-left: 2px solid ${color}; }\n                .CodeMirror-line .u-${id}.cursor.right      { border-right: 2px solid ${color}; }\n                .CodeMirror-line .u-${id}.empty             { background-color: transparent; }\n\n            `\n\t\t\tdocument.querySelector('head').appendChild(styleTag)\n\t\t}\n\n\t\tconst anchorMap = {}\n\t\tconst setAnchor = (id, anchor) => {\n\t\t\tif (id in anchorMap) {\n\t\t\t\tanchorMap[id].forEach(m => m.clear())\n\t\t\t\tdelete anchorMap[id]\n\t\t\t}\n\n\t\t\t// Whether or not the cursor is actually at the beginning\n\t\t\t// or end of the selection\n\t\t\tlet emptyClass = ''\n\t\t\tlet stindex = anchor.stindex\n\t\t\tconst edindex = anchor.edindex\n\n\t\t\t// Add selection\n\t\t\tlet stPos, edPos, range\n\t\t\tanchorMap[id] = []\n\n\t\t\tif (stindex !== edindex) {\n\t\t\t\tstPos = codeMirror.posFromIndex(stindex)\n\t\t\t\tedPos = codeMirror.posFromIndex(edindex)\n\n\t\t\t\tanchorMap[id].push(codeMirror.markText(stPos, edPos, { className: `u-${id}` }))\n\t\t\t}\n\n\t\t\tif (stindex === edindex) {\n\t\t\t\tstindex = Math.max(0, stindex - 1)\n\t\t\t\temptyClass = 'empty'\n\t\t\t}\n\n\t\t\t// Add cursor\n\t\t\tconst index = anchor.prefixed ? stindex : edindex\n\t\t\tstPos = codeMirror.posFromIndex(index + (anchor.prefixed ? 0 : -1))\n\t\t\tedPos = codeMirror.posFromIndex(index + (anchor.prefixed ? 1 : 0))\n\n\t\t\tanchorMap[id].push(\n\t\t\t\tcodeMirror.markText(stPos, edPos, {\n\t\t\t\t\tclassName: `u-${id} ${emptyClass} cursor ${anchor.prefixed ? 'left' : 'right'}`,\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\n\t\tconst removeId = id => {\n\t\t\tdocument.querySelector(`#users li.u-${id}`).remove()\n\t\t\tdocument.querySelector(`#style-${id}`).remove()\n\t\t\tif (id in anchorMap) {\n\t\t\t\tanchorMap[id].forEach(m => m.clear())\n\t\t\t\tdelete anchorMap[id]\n\t\t\t}\n\t\t}\n\n\t\tconst idToColor = id => {\n\t\t\tlet total = 0\n\t\t\tfor (let c of id) total += c.charCodeAt(0)\n\n\t\t\tlet hex = total.toString(16)\n\t\t\twhile (hex.length < 3) hex += hex[hex.length - 1]\n\t\t\thex = hex.substr(0, 3)\n\n\t\t\tlet color = '#'\n\t\t\tfor (let c of hex) color += `${c}0`\n\n\t\t\treturn color\n\t\t}\n\n\t\tconst hexToRgbaStyle = (hex, opacity) => {\n\t\t\thex = hex.replace('#', '')\n\t\t\tlet r, g, b, den\n\t\t\tif (hex.length === 3) {\n\t\t\t\tr = hex[0] + hex[0]\n\t\t\t\tg = hex[1] + hex[1]\n\t\t\t\tb = hex[2] + hex[2]\n\t\t\t} else {\n\t\t\t\tr = hex.substr(0, 2)\n\t\t\t\tg = hex.substr(2, 2)\n\t\t\t\tb = hex.substr(4, 2)\n\t\t\t}\n\n\t\t\tr = parseInt(r, 16)\n\t\t\tg = parseInt(g, 16)\n\t\t\tb = parseInt(b, 16)\n\n\t\t\treturn `rgba(${r},${g},${b},${opacity})`\n\t\t}\n\n\t\tconst clearAll = () => {\n\t\t\tfor (let key in anchorMap) removeId(key)\n\t\t}\n\n\t\tconst socket = io('http://localhost:4000')\n\t\tsocket.on('connect', () => {\n\t\t\tsocket.on('disconnect', () => clearAll())\n\n\t\t\tsocket.once('initialize', e => {\n\t\t\t\tfor (let id in e.anchors) socket.id !== id && setAnchor(id, e.anchors[id])\n\t\t\t\tfor (let id in e.names) socket.id !== id && addName(id, e.names[id])\n\t\t\t})\n\t\t\tsocket.on('anchor-update', e => {\n\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\tsetAnchor(e.id, e.anchor)\n\t\t\t})\n\t\t\tsocket.on('id-join', e => {\n\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\taddName(e.id, e.name)\n\t\t\t\tsetAnchor(e.id, e.anchor)\n\t\t\t})\n\t\t\tsocket.on('id-left', e => {\n\t\t\t\tif (socket.id === e.id) return\n\n\t\t\t\tremoveId(e.id)\n\t\t\t})\n\t\t})\n\t}\n\n\trender() {\n\t\tconst { codeMirror } = this.props\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<textarea ref={this.editorRef} />\n\t\t\t\t<FakeButtonsElement id=\"wmd-button-bar\" />\n\t\t\t</>\n\t\t)\n\t}\n}\n\nconst mapStateToProps = ({ editor: { codeMirror } }) => ({ codeMirror })\n\nconst mapDispatchToProps = { setCmInstance }\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(Editor)\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\"\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/visibility-on.9440d095.svg\";\nexport { SvgComponent as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\n\nvar _ref =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0zm0 0h24v24H0z\",\n  fill: \"none\"\n});\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z\"\n});\n\nvar SvgComponent = function SvgComponent(props) {\n  return React.createElement(\"svg\", _extends({\n    width: 24,\n    height: 24,\n    viewBox: \"0 0 24 24\"\n  }, props), _ref, _ref2);\n};\n\nexport default __webpack_public_path__ + \"static/media/visibility-off.4a19fae5.svg\";\nexport { SvgComponent as ReactComponent };","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport styled from 'styled-components'\n\nimport Editor from '../Editor/Editor'\nimport ReactMarkdown from 'react-markdown'\n\nimport { toggleRenderMarkdown } from '../../actions/renderMarkdown'\n\nimport { ReactComponent as VisibilityOn } from '../../icons/visibility-on.svg'\nimport { ReactComponent as VisibilityOff } from '../../icons/visibility-off.svg'\n\nconst Wrapper = styled.div`\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n`\n\nconst StyledPaper = styled.div`\n\tmargin-top: 40px;\n\twidth: calc(var(--container-width) - 60px);\n\tpadding: 30px;\n\tbackground-color: white;\n\tbox-shadow: 10px 20px 20px rgba(0, 0, 0, 0.25);\n`\n\nconst VisibilityWrapper = styled.div`\n\tdisplay: ${props => (props.visible ? 'block' : 'none')};\n`\n\nconst MarkdownRenderWrapper = styled.div`\n\tmin-height: calc(100vh - 188px);\n\tpadding: 14px;\n\toverflow-wrap: break-word;\n`\n\nconst RenderButton = styled.div`\n\tposition: fixed;\n\twidth: 0;\n\theight: 0;\n\ttop: 60px;\n\tright: 0;\n\tborder: 40px solid rgba(0, 0, 0, 0.1);\n\tborder-bottom-color: transparent;\n\tborder-left-color: transparent;\n\tcursor: pointer;\n\tz-index: 2;\n\t&::after {\n\t\tcontent: '';\n\t\tclear: both;\n\t}\n\tsvg {\n\t\tposition: absolute;\n\t\tmargin-left: 5px;\n\t\tmargin-top: -30px;\n\t\tcolor: var(--c-darkgrey-bg);\n\t}\n`\n\nclass Paper extends Component {\n\trender() {\n\t\tconst { renderMarkdown, toggleRenderMarkdown, codeMirror } = this.props\n\n\t\treturn (\n\t\t\t<Wrapper>\n\t\t\t\t<StyledPaper>\n\t\t\t\t\t<RenderButton onClick={toggleRenderMarkdown}>\n\t\t\t\t\t\t{renderMarkdown ? <VisibilityOff /> : <VisibilityOn />}\n\t\t\t\t\t</RenderButton>\n\t\t\t\t\t<VisibilityWrapper visible={!renderMarkdown}>\n\t\t\t\t\t\t<Editor />\n\t\t\t\t\t</VisibilityWrapper>\n\t\t\t\t\t<VisibilityWrapper visible={renderMarkdown}>\n\t\t\t\t\t\t<MarkdownRenderWrapper>\n\t\t\t\t\t\t\t<ReactMarkdown source={codeMirror.doc && codeMirror.doc.getValue()} />\n\t\t\t\t\t\t</MarkdownRenderWrapper>\n\t\t\t\t\t</VisibilityWrapper>\n\t\t\t\t</StyledPaper>\n\t\t\t</Wrapper>\n\t\t)\n\t}\n}\n\nconst mapStateToProps = ({ renderMarkdown, editor: { codeMirror } }) => ({ renderMarkdown, codeMirror })\n\nconst mapDispatchToProps = { toggleRenderMarkdown }\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(Paper)\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport { createGlobalStyle } from 'styled-components'\n\nimport Toolbar from '../Toolbar/Toolbar'\nimport Sidebar from '../Sidebar/Sidebar'\nimport Paper from '../Paper/Paper'\n\nimport { requestUserData } from '../../actions/user'\n\nconst GlobalStyle = createGlobalStyle`\n\t* {\n        margin: 0;\n        padding: 0;\n\t}\n    body {\n        font-family: Roboto;\n\t\tbackground-color: var(--c-lightgrey-bg);\n\t\tpadding-top: 60px;\n    }\n    :root {\n        font-size: 18px;\n\n\t\t--container-width: 1200px;\n\t\t--max-width: 1700px;\n\t\n        --c-lightgrey-bg: #eee;\n\t\t--c-darkgrey-bg: #3E3E3E;\n\t\t--c-white-hl: rgba(255, 255, 255, 0.65);\n\t\t--c-blue-hl: #00B2FF;\n        --c-lightgrey-text: #eee;\n\t\t--c-grey-text: #B9B9B9;\n\t\t--c-darkgrey-text: #555;\n\n\t\t@media (max-width: 1920px) {\n\t\t\t--container-width: 60vw;\n\t\t\t--max-width: calc(60vw + 500px);\n\t\t}\n\t\t@media (max-width: 1680px) {\n\t\t\t--container-width: 70vw;\n\t\t\t--max-width: 100vw;\n\t\t}\n    }\n`\n\nclass App extends Component {\n\tcomponentDidMount() {\n\t\tthis.props.requestUserData()\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<Toolbar />\n\t\t\t\t<Sidebar />\n\t\t\t\t<Paper />\n\t\t\t\t<GlobalStyle />\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nconst mapDispatchToProps = { requestUserData }\n\nexport default connect(\n\tnull,\n\tmapDispatchToProps\n)(App)\n","import React from 'react'\nimport { render } from 'react-dom'\nimport { createStore, applyMiddleware, compose } from 'redux'\nimport { Provider } from 'react-redux'\nimport thunkMiddleware from 'redux-thunk'\nimport registerServiceWorker from './registerServiceWorker'\nimport rootReducer from './reducers'\n\nimport App from './components/App/App'\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\nconst store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunkMiddleware)\n));\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\nregisterServiceWorker()\n"],"sourceRoot":""}